(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{7969:function(e,s,a){Promise.resolve().then(a.bind(a,57910))},57910:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return eB}});var t=a(3827),l=a(64090),r=a(96322),n=a(47907),i=a(67445),d=a(31518),c=a(52235),o=a(79744),x=a(31047),m=a(72891),h=a(29733),u=a(30438),g=a(87479),j=a(34059),f=a(32805),p=a(69475),b=a(29910),v=a(43081),y=a(47367),N=a(11213),w=a(10527),k=a(81049),S=a(61604);function Z(e){let{activeTab:s,setActiveTab:a,userRole:r}=e,[i,d]=(0,l.useState)(!1),[Z,C]=(0,l.useState)(!1),E=(0,n.useRouter)(),I="AGENT"===r;(0,l.useEffect)(()=>{let e=()=>C(document.documentElement.classList.contains("dark"));e();let s=new MutationObserver(e);return s.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>s.disconnect()},[]),(0,l.useEffect)(()=>{d(!1)},[s]),(0,l.useEffect)(()=>(i?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[i]);let T=e=>{let{icon:l,label:r,id:n,dataTour:i}=e;return(0,t.jsxs)("button",{onClick:()=>a(n),"data-tour":i,className:"w-full flex items-center gap-4 px-6 py-4 transition-all duration-300 ".concat(s===n?"bg-brand-600/10 text-brand-600 dark:bg-brand-500/10 dark:text-brand-400 border-r-4 border-brand-600":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-cosmic-800 active:bg-gray-200 dark:active:bg-cosmic-700"),children:[(0,t.jsx)(l,{size:22}),(0,t.jsx)("span",{className:"font-medium text-lg",children:r})]})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"md:hidden fixed top-0 left-0 right-0 z-50 bg-white/95 dark:bg-cosmic-950/95 backdrop-blur-xl border-b border-gray-200 dark:border-cosmic-800 shadow-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,t.jsx)("button",{onClick:()=>d(!i),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-cosmic-800 transition-colors focus-visible-ring","aria-label":i?"إغلاق القائمة":"فتح القائمة",children:i?(0,t.jsx)(c.Z,{size:24,className:"text-gray-700 dark:text-gray-200"}):(0,t.jsx)(o.Z,{size:24,className:"text-gray-700 dark:text-gray-200"})}),(0,t.jsx)("div",{className:"w-8 h-8",children:(0,t.jsx)(S.Z,{size:"tiny",showText:!1})}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("button",{onClick:()=>{Z?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"),C(!1)):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark"),C(!0))},className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-cosmic-800 transition-colors focus-visible-ring","aria-label":Z?"التبديل للوضع النهاري":"التبديل للوضع الليلي",children:Z?(0,t.jsx)(x.Z,{size:20,className:"text-yellow-500"}):(0,t.jsx)(m.Z,{size:20,className:"text-gray-600"})})})]})}),i&&(0,t.jsx)("div",{className:"md:hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40 animate-in fade-in duration-200",onClick:()=>d(!1)}),(0,t.jsx)("div",{className:"md:hidden fixed top-0 right-0 h-full w-[280px] bg-white dark:bg-cosmic-950 z-50 shadow-2xl transform transition-transform duration-300 ease-out ".concat(i?"translate-x-0":"translate-x-full"),children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-cosmic-800 bg-gradient-to-b from-gray-50 dark:from-cosmic-900 to-transparent",children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)(S.Z,{size:"small",showText:!0}),(0,t.jsx)("button",{onClick:()=>d(!1),className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-cosmic-800 transition-colors",children:(0,t.jsx)(c.Z,{size:20})})]})}),(0,t.jsxs)("nav",{className:"flex-1 overflow-y-auto custom-scrollbar py-2",children:[!I&&(0,t.jsx)(T,{icon:h.Z,label:"نظرة عامة",id:"overview",dataTour:"sidebar-overview"}),(0,t.jsx)(T,{icon:u.Z,label:"المحادثات",id:"conversations",dataTour:"sidebar-conversations"}),(0,t.jsx)(T,{icon:g.Z,label:"الدعم المباشر",id:"live-support"}),!I&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T,{icon:j.Z,label:"فريق العمل",id:"team"}),(0,t.jsx)(T,{icon:f.Z,label:"قنوات الاتصال",id:"channels"}),(0,t.jsx)(T,{icon:p.Z,label:"قاعدة المعرفة",id:"knowledge",dataTour:"sidebar-knowledge"}),(0,t.jsx)(T,{icon:b.Z,label:"تخصيص الويدجت",id:"widget",dataTour:"sidebar-widget"}),(0,t.jsx)(T,{icon:v.Z,label:"تجربة البوت",id:"playground"})]}),(0,t.jsx)(T,{icon:y.Z,label:"تذاكر الدعم",id:"tickets"}),(0,t.jsx)(T,{icon:N.Z,label:"إعدادات الحساب",id:"settings",dataTour:"sidebar-settings"}),!I&&(0,t.jsx)(T,{icon:w.Z,label:"الاشتراك والباقة",id:"subscription"})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-cosmic-800 bg-gradient-to-t from-gray-50 dark:from-cosmic-900 to-transparent space-y-3",children:[(0,t.jsxs)("button",{onClick:()=>a("tickets"),className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400 hover:bg-brand-100 dark:hover:bg-brand-900/30 transition-colors font-medium",children:[(0,t.jsx)(y.Z,{size:20}),(0,t.jsx)("span",{children:"الدعم الفني"})]}),(0,t.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),E.push("/login")},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors font-medium",children:[(0,t.jsx)(k.Z,{size:20}),(0,t.jsx)("span",{children:"تسجيل الخروج"})]})]})]})})]})}var C=a(18994),E=a(80037),I=a(61524),T=a(63861),D=a(93459),z=a(28745),A=a(38371),O=a(19407);function F(e){let{children:s}=e,a=(0,n.useRouter)(),[r,i]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{let e=localStorage.getItem("token"),s=localStorage.getItem("user");e&&s?i(!0):a.push("/login")},[a]),r)?(0,t.jsx)(t.Fragment,{children:s}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsx)(C.Z,{className:"w-10 h-10 animate-spin text-brand-500"})})}var R=a(28398),B=a(98998),Y=a(26490),M=a(10775),P=a(95032),U=a(23416),L=a(77819),_=a(66363),K=a(38333),q=a(23356),W=a(22983),G=a(85758),V=a(98964),Q=a(23168),H=a(48713),J=a(74994),X=a(94830),$=a(51161),ee=a(44191),es=a(81433),ea=a(86526);function et(e){let{stats:s,subscription:a,kbList:r,chartData:n,user:d,setActiveTab:c}=e,[o,x]=(0,l.useState)(!1),[m,g]=(0,l.useState)({activeUsers:0,responseTime:0,satisfaction:0}),[f,p]=(0,l.useState)(7),[b,v]=(0,l.useState)(""),[y,N]=(0,l.useState)(""),[w,k]=(0,l.useState)([]),[S,Z]=(0,l.useState)([]),[C,I]=(0,l.useState)([]),[D,z]=(0,l.useState)("area"),[O,F]=(0,l.useState)(null),[et,el]=(0,l.useState)([]),er="dashboardSync";(0,l.useEffect)(()=>{let e=setInterval(()=>{g({activeUsers:Math.floor(50*Math.random())+10,responseTime:Math.floor(2e3*Math.random())+500,satisfaction:Math.floor(20*Math.random())+80})},5e3);return()=>clearInterval(e)},[]),(0,l.useEffect)(()=>{let e=!0;return(async()=>{try{let s=b&&y?"/api/analytics/dashboard?start=".concat(encodeURIComponent(b),"&end=").concat(encodeURIComponent(y)):"/api/analytics/dashboard-public/".concat(f),a=await fetch(s);if(!a.ok)throw Error("HTTP ".concat(a.status));let t=await a.json();if(!e)return;let l=t.data||t;k(l.trends&&l.trends.daily||ed),Z(l.performance&&l.performance.responseTimes||ec),I(l.performance&&l.performance.satisfactionDistribution||eo)}catch(e){console.warn("Failed to fetch analytics:",e.message||e)}})(),(async()=>{try{let s=await fetch("/api/analytics/vector-stats");if(!s.ok)throw Error("vector stats fetch failed");let a=await s.json();e&&F(a.data||a)}catch(e){}})(),()=>{e=!1}},[f,b,y]),(0,l.useEffect)(()=>{el([{id:1,type:"warning",message:"High response time detected",time:"2 min ago"},{id:2,type:"info",message:"New user registered",time:"5 min ago"}])},[]),(0,l.useEffect)(()=>{let e=!0;return async function(s){try{let a=await fetch("/api/analytics/dashboard/".concat(s));if(!a.ok)throw Error("Status ".concat(a.status));let t=await a.json();if(!e)return;let l=t.data||t;l.trends&&l.trends.daily&&k(l.trends.daily.map(e=>({name:e.dateLabel||e.date,conversations:e.count}))),l.performance&&l.performance.responseTimeSeries&&Z(l.performance.responseTimeSeries.map(e=>({name:e.timeLabel||e.time,time:e.avg}))),l.performance&&l.performance.satisfactionDistribution&&I(l.performance.satisfactionDistribution.map(e=>({name:e.label,value:e.value,color:e.color||"#8884d8"})))}catch(e){console.warn("Failed to load analytics:",e)}}(f),()=>{e=!1}},[f]);let en=e=>{if(!e)return"غير معروف";let s=Math.floor((new Date-new Date(e))/1e3),a=s/31536e3;return a>1?"منذ ".concat(Math.floor(a)," سنة"):(a=s/2592e3)>1?"منذ ".concat(Math.floor(a)," شهر"):(a=s/86400)>1?"منذ ".concat(Math.floor(a)," يوم"):(a=s/3600)>1?"منذ ".concat(Math.floor(a)," ساعة"):(a=s/60)>1?"منذ ".concat(Math.floor(a)," دقيقة"):"منذ لحظات"},ei=()=>{try{let e=[],s=w&&w.length?w:ed;e.push(["Exported At",new Date().toISOString()]),e.push(["Business",(null==d?void 0:d.businessId)||"unknown"]),e.push(["Time Range Days",f]),e.push([]),e.push(["Conversations (date)","count"]),s.forEach(s=>e.push([s.name,s.conversations])),e.push([]);let a=S&&S.length?S:ec;e.push(["Response Time (time)","ms"]),a.forEach(s=>e.push([s.name,s.time])),e.push([]);let t=C&&C.length?C:eo;e.push(["Satisfaction Level","value"]),t.forEach(s=>e.push([s.name,s.value]));let l=e.map(e=>e.map(e=>'"'.concat(String(e||""),'"')).join(",")).join("\n"),r=new Blob([l],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download="analytics_export_".concat(f,"d_").concat(Date.now(),".csv"),document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(n)}catch(e){console.error("Export CSV failed",e),alert("فشل تصدير البيانات")}},ed=[{name:"Mon",conversations:120},{name:"Tue",conversations:150},{name:"Wed",conversations:180},{name:"Thu",conversations:200},{name:"Fri",conversations:220},{name:"Sat",conversations:190},{name:"Sun",conversations:160}],ec=[{name:"00:00",time:1200},{name:"04:00",time:1100},{name:"08:00",time:1300},{name:"12:00",time:1400},{name:"16:00",time:1250},{name:"20:00",time:1150}],eo=[{name:"Very Satisfied",value:45,color:"#10B981"},{name:"Satisfied",value:35,color:"#3B82F6"},{name:"Neutral",value:15,color:"#F59E0B"},{name:"Dissatisfied",value:5,color:"#EF4444"}];return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-8",id:"dashboard-overview",children:[et.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:et.map(e=>(0,t.jsx)(A.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-4 rounded-lg border ".concat("warning"===e.type?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"),children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.message}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground ml-auto",children:e.time})]})},e.id))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"Active Users"}),(0,t.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:m.activeUsers}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,t.jsx)(h.Z,{className:"inline h-3 w-3 text-green-500"})," +12% from last hour"]})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"Avg Response Time"}),(0,t.jsx)(Y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[m.responseTime,"ms"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,t.jsx)(M.Z,{className:"inline h-3 w-3 text-green-500"})," -5% from yesterday"]})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"Satisfaction Rate"}),(0,t.jsx)(P.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[m.satisfaction,"%"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,t.jsx)(h.Z,{className:"inline h-3 w-3 text-green-500"})," +2% from last week"]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"نطاق التاريخ:"}),(0,t.jsxs)("select",{value:f,onChange:e=>{p(parseInt(e.target.value,10)),v(""),N("")},className:"text-sm p-1 border rounded",children:[(0,t.jsx)("option",{value:7,children:"7 أيام"}),(0,t.jsx)("option",{value:30,children:"30 يوم"}),(0,t.jsx)("option",{value:90,children:"90 يوم"})]}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"أو"}),(0,t.jsx)("input",{type:"date",className:"text-sm p-1 border rounded",value:b,onChange:e=>v(e.target.value)}),(0,t.jsx)("input",{type:"date",className:"text-sm p-1 border rounded",value:y,onChange:e=>N(e.target.value)}),(0,t.jsx)(i.z,{size:"sm",onClick:()=>{b&&y&&p(0)},children:"Apply"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground mr-1",children:"نوع المخطط:"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(i.z,{size:"sm",variant:"area"===D?"default":"outline",onClick:()=>z("area"),children:"Area"}),(0,t.jsx)(i.z,{size:"sm",variant:"line"===D?"default":"outline",onClick:()=>z("line"),children:"Line"}),(0,t.jsx)(i.z,{size:"sm",variant:"bar"===D?"default":"outline",onClick:()=>z("bar"),children:"Bar"})]})]}),(0,t.jsx)(i.z,{size:"sm",onClick:()=>window.open("/api/analytics/export?format=csv&days=".concat(f)),children:"تصدير CSV"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(R.Zb,{className:"glass-panel smooth-transition",children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsxs)(R.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5 text-brand-500"}),"اتجاهات المحادثات"]}),(0,t.jsx)(R.SZ,{children:"المحادثات اليومية خلال الأسبوع الماضي"})]}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"h-[300px]",children:(0,t.jsx)(L.h,{width:"100%",height:"100%",children:(0,t.jsxs)(_.w,{syncId:er,data:w&&w.length?w:ed,children:[(0,t.jsx)(K.q,{strokeDasharray:"3 3"}),(0,t.jsx)(q.K,{dataKey:"name"}),(0,t.jsx)(W.B,{}),(0,t.jsx)(G.u,{}),(0,t.jsx)(V.x1,{type:"monotone",dataKey:"conversations",stroke:"#3B82F6",strokeWidth:2,dot:{fill:"#3B82F6",strokeWidth:2,r:4}})]})})})})]}),(0,t.jsxs)(R.Zb,{className:"glass-panel smooth-transition",children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsxs)(R.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.Z,{className:"h-5 w-5 text-green-500"}),"أوقات الاستجابة"]}),(0,t.jsx)(R.SZ,{children:"متوسط أوقات الاستجابة بالميلي ثانية"})]}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"h-[300px]",children:(0,t.jsx)(L.h,{width:"100%",height:"100%",children:(0,t.jsxs)(_.w,{syncId:er,data:S&&S.length?S:ec,children:[(0,t.jsx)(K.q,{strokeDasharray:"3 3"}),(0,t.jsx)(q.K,{dataKey:"name"}),(0,t.jsx)(W.B,{}),(0,t.jsx)(G.u,{}),(0,t.jsx)(V.x1,{type:"monotone",dataKey:"time",stroke:"#10B981",strokeWidth:2,dot:{fill:"#10B981",strokeWidth:2,r:4}})]})})})})]})]}),(0,t.jsxs)(R.Zb,{className:"glass-panel smooth-transition",children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsxs)(R.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(P.Z,{className:"h-5 w-5 text-purple-500"}),"توزيع الرضا"]}),(0,t.jsx)(R.SZ,{children:"توزيع مستويات رضا العملاء"})]}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"h-[300px] flex items-center justify-center",children:(0,t.jsx)(L.h,{width:"100%",height:"100%",children:(0,t.jsxs)(Q.u,{children:[(0,t.jsx)(H.by,{data:C&&C.length?C:eo,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:a}=e;return"".concat(s," ").concat((100*a).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:eo.map((e,s)=>(0,t.jsx)(J.b,{fill:e.color},"cell-".concat(s)))}),(0,t.jsx)(G.u,{})]})})})}),(0,t.jsx)(R.aY,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,t.jsx)("div",{className:"h-[300px]",children:(0,t.jsx)(L.h,{width:"100%",height:"100%",children:(0,t.jsxs)(Q.u,{children:[(0,t.jsx)(H.by,{data:C&&C.length?C:eo,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,percent:a}=e;return"".concat(s," ").concat((100*a).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:(C&&C.length?C:eo).map((e,s)=>(0,t.jsx)(J.b,{fill:e.color||e.fill||"#8884d8"},"cell-".concat(s)))}),(0,t.jsx)(G.u,{})]})})}),(0,t.jsx)("div",{className:"h-[300px]",children:(0,t.jsxs)(L.h,{width:"100%",height:"100%",children:["area"===D&&(0,t.jsxs)(X.T,{syncId:er,data:w&&w.length?w:ed,children:[(0,t.jsx)("defs",{children:(0,t.jsxs)("linearGradient",{id:"colorConv",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),(0,t.jsx)("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),(0,t.jsx)(q.K,{dataKey:"name"}),(0,t.jsx)(W.B,{}),(0,t.jsx)(K.q,{strokeDasharray:"3 3"}),(0,t.jsx)(G.u,{}),(0,t.jsx)($.uN,{type:"monotone",dataKey:"conversations",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorConv)"}),(0,t.jsx)(ee.B,{dataKey:"name",height:30,stroke:"#8884d8"})]}),"line"===D&&(0,t.jsxs)(_.w,{syncId:er,data:w&&w.length?w:ed,children:[(0,t.jsx)(K.q,{strokeDasharray:"3 3"}),(0,t.jsx)(q.K,{dataKey:"name"}),(0,t.jsx)(W.B,{}),(0,t.jsx)(G.u,{}),(0,t.jsx)(V.x1,{type:"monotone",dataKey:"conversations",stroke:"#3B82F6",strokeWidth:2,dot:{r:4}}),(0,t.jsx)(ee.B,{dataKey:"name",height:30,stroke:"#3B82F6"})]}),"bar"===D&&(0,t.jsxs)(es.v,{syncId:er,data:w&&w.length?w:ed,children:[(0,t.jsx)(K.q,{strokeDasharray:"3 3"}),(0,t.jsx)(q.K,{dataKey:"name"}),(0,t.jsx)(W.B,{}),(0,t.jsx)(G.u,{}),(0,t.jsx)(ea.$Q,{dataKey:"conversations",fill:"#3B82F6"}),(0,t.jsx)(ee.B,{dataKey:"name",height:30,stroke:"#3B82F6"})]})]})})]})})]}),(0,t.jsxs)(R.Zb,{className:"glass-panel smooth-transition",children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsxs)(R.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-5 w-5 text-blue-500"}),"استخدام الرسائل"]}),(0,t.jsx)(R.SZ,{children:"رصيد الرسائل المستخدم والمتبقي"})]}),(0,t.jsx)(R.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"الاستخدام الحالي"}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:[(null==a?void 0:a.messagesUsed)||0," / ",(null==a?void 0:a.messageQuota)||2e3]})]}),(0,t.jsx)("div",{className:"w-full bg-muted h-4 rounded-full overflow-hidden relative",children:(0,t.jsx)(A.E.div,{initial:{width:0},animate:{width:"".concat(Math.min(((null==a?void 0:a.messagesUsed)||0)/((null==a?void 0:a.messageQuota)||2e3)*100,100),"%")},transition:{duration:1,ease:"easeOut"},className:"bg-gradient-to-r from-brand-500 to-brand-600 h-full rounded-full"})}),(0,t.jsxs)("div",{className:"text-right mt-1 text-xs text-muted-foreground",children:["تم استخدام"," ",Math.round(((null==a?void 0:a.messagesUsed)||0)/((null==a?void 0:a.messageQuota)||2e3)*100),"%"]})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)(R.Zb,{className:"glass-panel glass-panel-hover smooth-transition",children:[(0,t.jsx)(R.Ol,{className:"pb-2",children:(0,t.jsxs)(R.ll,{className:"text-sm font-medium text-muted-foreground flex justify-between",children:["الباقة الحالية",(0,t.jsx)("div",{className:"p-2 bg-brand-500/10 rounded-lg",children:(0,t.jsx)(T.Z,{className:"h-4 w-4 text-brand-500"})})]})}),(0,t.jsxs)(R.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[(null==a?void 0:a.planType)==="TRIAL"&&"تجريبية",(null==a?void 0:a.planType)==="BASIC"&&"الأساسية",(null==a?void 0:a.planType)==="PRO"&&"الاحترافية",(null==a?void 0:a.planType)==="ENTERPRISE"&&"الشركات",(null==a?void 0:a.planType)==="AGENCY"&&"الوكالات"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(null==a?void 0:a.trialEndsAt)?"تنتهي في ".concat(new Date(a.trialEndsAt).toLocaleDateString("ar-SA")):"اشتراك نشط"})]})]}),(0,t.jsxs)(R.Zb,{className:"glass-panel glass-panel-hover smooth-transition",children:[(0,t.jsx)(R.Ol,{className:"pb-2",children:(0,t.jsxs)(R.ll,{className:"text-sm font-medium text-muted-foreground flex justify-between",children:["الرصيد المتبقي",(0,t.jsx)("div",{className:"p-2 bg-green-500/10 rounded-lg",children:(0,t.jsx)(u.Z,{className:"h-4 w-4 text-green-500"})})]})}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:((null==a?void 0:a.messageQuota)||0)-((null==a?void 0:a.messagesUsed)||0)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"رسالة متاحة"})]})]}),(0,t.jsxs)(R.Zb,{className:"glass-panel glass-panel-hover smooth-transition",children:[(0,t.jsx)(R.Ol,{className:"pb-2",children:(0,t.jsxs)(R.ll,{className:"text-sm font-medium text-muted-foreground flex justify-between",children:["إجمالي المحادثات",(0,t.jsx)("div",{className:"p-2 bg-purple-500/10 rounded-lg",children:(0,t.jsx)(j.Z,{className:"h-4 w-4 text-purple-500"})})]})}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(null==s?void 0:s.totalConversations)||0}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"محادثة مسجلة"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)(R.Zb,{className:"lg:col-span-1 h-full glass-panel smooth-transition",children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"المصادر النشطة"})}),(0,t.jsx)(R.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[r&&r.slice(0,3).map(e=>{var s,a,l,r;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/30 border border-border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 overflow-hidden",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500 flex-shrink-0"}),(0,t.jsxs)("div",{className:"truncate",children:[(0,t.jsx)("p",{className:"font-medium text-sm truncate",children:(null===(s=e.metadata)||void 0===s?void 0:s.filename)||(null===(a=e.metadata)||void 0===a?void 0:a.title)||(null===(l=e.metadata)||void 0===l?void 0:l.url)||"بدون عنوان"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"PDF"===e.type?"تمت المعالجة \xb7 ".concat((null===(r=e.metadata)||void 0===r?void 0:r.pageCount)||"?"," صفحة"):"نشط \xb7 ".concat(en(e.updatedAt))})]})]}),(0,t.jsx)("span",{className:"text-[10px] px-2 py-1 bg-muted rounded uppercase",children:e.type})]},e.id)}),(!r||0===r.length)&&(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground border border-dashed border-border rounded-lg",children:"لا يوجد مصادر نشطة"}),(0,t.jsxs)("div",{className:"pt-4 border-t border-dashed",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"أضف المزيد من المصادر لتحسين الدقة"}),(0,t.jsx)(i.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>c("knowledge"),children:"رفع جديد"})]})]})})]}),(0,t.jsxs)(R.Zb,{className:"lg:col-span-2 glass-panel smooth-transition",children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"تحليل المحادثات (آخر 7 أيام)"})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"h-[300px] w-full flex items-end justify-between gap-2 pt-8 px-2",children:n&&n.length>0?n.map((e,s)=>(0,t.jsxs)("div",{className:"w-full bg-brand-500/10 rounded-t-lg relative group hover:bg-brand-500/20 transition-colors flex flex-col justify-end items-center",style:{height:"100%"},children:[(0,t.jsx)("div",{className:"mb-2 font-bold text-brand-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.count}),(0,t.jsx)(A.E.div,{initial:{height:0},animate:{height:"".concat(Math.max(e.count/Math.max(...n.map(e=>e.count),1)*100,5),"%")},transition:{delay:.05*s,duration:.5},className:"w-full bg-brand-500 rounded-t-lg opacity-80 group-hover:opacity-100"}),(0,t.jsx)("div",{className:"mt-2 text-xs text-muted-foreground",children:e.date})]},s)):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"لا توجد بيانات كافية للعرض"})})})]})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsx)(R.ll,{children:"كود التضمين"}),(0,t.jsx)(R.SZ,{children:"انسخ هذا الكود وضعه في وسم body في موقعك"})]}),(0,t.jsx)(R.aY,{children:(0,t.jsxs)("div",{className:"relative group",dir:"ltr",children:[(0,t.jsxs)("div",{className:"bg-muted p-4 rounded-lg font-mono text-xs break-all border border-border",children:['<script src="https://fahimo-api.onrender.com/widget/fahimo-widget.js" data-business-id="',null==d?void 0:d.businessId,'"></script>']}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2",children:[(0,t.jsxs)(i.z,{size:"sm",onClick:()=>{let e=(null==d?void 0:d.businessId)||"YOUR_BUSINESS_ID";navigator.clipboard.writeText('<script src="https://fahimo-api.onrender.com/widget/fahimo-widget.js" data-business-id="'.concat(e,'"></script>')),x(!0),setTimeout(()=>x(!1),2e3)},children:[o?(0,t.jsx)(E.Z,{className:"w-4 h-4 mr-1"}):(0,t.jsx)(U.Z,{className:"w-4 h-4 mr-1"}),o?"تم النسخ":"نسخ"]}),(0,t.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>ei(),children:"تصدير بيانات"})]})]})})]})})]})}var el=a(61262),er=a(26509);function en(){let[e,s]=(0,l.useState)([]),[a,r]=(0,l.useState)(null),[n,d]=(0,l.useState)([]),[c,o]=(0,l.useState)(""),[x,m]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!0);(0,l.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=await O.xU.getConversations();s(e)}catch(e){console.error(e)}finally{g(!1)}},f=async e=>{r(e);try{let s=await O.xU.getMessages(e.id);d(s)}catch(e){console.error(e)}},p=async e=>{if(e.preventDefault(),c.trim()&&a){m(!0);try{let e=await O.xU.reply(a.id,c);d(s=>[...s,e]),o("")}catch(e){console.error("Failed to send reply",e)}finally{m(!1)}}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"grid grid-cols-1 lg:grid-cols-3 gap-8 h-[calc(100vh-140px)]",children:[(0,t.jsxs)(R.Zb,{className:"lg:col-span-1 flex flex-col h-full",children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"المحادثات النشطة"})}),(0,t.jsx)(R.aY,{className:"flex-1 overflow-y-auto p-2",children:h?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(C.Z,{className:"animate-spin"})}):0===e.length?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"لا توجد محادثات"}):e.map(e=>{var s;return(0,t.jsxs)("div",{onClick:()=>f(e),className:"p-3 mb-2 rounded-lg cursor-pointer transition-colors ".concat((null==a?void 0:a.id)===e.id?"bg-brand-500/10 border border-brand-500/20":"hover:bg-muted"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"font-medium text-sm",children:["زائر #",e.id.slice(-4)]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(e.updatedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground truncate mt-1",children:(null===(s=e.messages[0])||void 0===s?void 0:s.content)||"لا توجد رسائل"})]},e.id)})})]}),(0,t.jsx)(R.Zb,{className:"lg:col-span-2 flex flex-col h-full",children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Ol,{className:"border-b py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-brand-500/20 rounded-full flex items-center justify-center text-brand-500",children:(0,t.jsx)(N.Z,{className:"w-4 h-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(R.ll,{className:"text-base",children:["زائر #",a.id.slice(-4)]}),(0,t.jsxs)(R.SZ,{className:"text-xs",children:["عبر ",a.channel]})]})]})}),(0,t.jsx)(R.aY,{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-muted/10",children:n.map((e,s)=>(0,t.jsxs)("div",{className:"flex gap-3 ".concat("ASSISTANT"===e.role?"flex-row-reverse":""),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat("ASSISTANT"===e.role?"bg-brand-500 text-white":"bg-gray-200 dark:bg-gray-700"),children:"ASSISTANT"===e.role?(0,t.jsx)(er.Z,{className:"w-4 h-4"}):(0,t.jsx)(N.Z,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"p-3 rounded-lg max-w-[80%] text-sm ".concat("ASSISTANT"===e.role?"bg-brand-500 text-white rounded-tl-none":"bg-white dark:bg-gray-800 border border-border rounded-tr-none"),children:e.content})]},s))}),(0,t.jsx)(R.eW,{className:"border-t p-3",children:(0,t.jsxs)("form",{onSubmit:p,className:"flex w-full gap-2",children:[(0,t.jsx)(el.I,{value:c,onChange:e=>o(e.target.value),placeholder:"اكتب ردك هنا...",className:"flex-1 bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),(0,t.jsx)(i.z,{type:"submit",disabled:x||!c.trim(),children:x?(0,t.jsx)(C.Z,{className:"animate-spin"}):"إرسال"})]})})]}):(0,t.jsxs)("div",{className:"flex-1 flex items-center justify-center text-muted-foreground flex-col gap-4",children:[(0,t.jsx)(u.Z,{className:"w-12 h-12 opacity-20"}),(0,t.jsx)("p",{children:"اختر محادثة للبدء"})]})})]})}function ei(e){let{addNotification:s}=e,[a,r]=(0,l.useState)([]),n=(0,l.useRef)(null);(0,l.useEffect)(()=>{d();let e=setInterval(d,1e4);return()=>clearInterval(e)},[]);let d=async()=>{try{let e=await O.xU.getHandoverRequests();e.length>a.length&&(c(),s("طلب دعم جديد!","success")),r(e)}catch(e){console.error(e)}},c=()=>{n.current&&n.current.play().catch(e=>console.log("Audio play failed",e))};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"الدعم المباشر (Live Agent)"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"إدارة طلبات التحويل للموظفين"})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-green-500/10 text-green-500 rounded-full text-sm",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"النظام نشط"]})})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsx)(R.ll,{children:"طلبات الانتظار"}),(0,t.jsx)(R.SZ,{children:"العملاء الذين يطلبون التحدث مع موظف"})]}),(0,t.jsx)(R.aY,{children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(g.Z,{className:"w-8 h-8 opacity-50"})}),(0,t.jsx)("p",{children:"لا توجد طلبات انتظار حالياً"})]}):(0,t.jsx)("div",{className:"space-y-4",children:a.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card hover:bg-muted/50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-brand-500/10 flex items-center justify-center text-brand-500",children:(0,t.jsx)(N.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-bold",children:["زائر #",e.conversationId.slice(-4)]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["منذ ",new Date(e.createdAt).toLocaleTimeString()]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.z,{size:"sm",variant:"outline",children:"تجاهل"}),(0,t.jsx)(i.z,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:"قبول المحادثة"})]})]},s))})})]}),(0,t.jsx)("audio",{ref:n,src:"/notification.mp3",preload:"none"})]})}var ed=a(20244);function ec(e){var s,a;let{addNotification:r}=e,[n,d]=(0,l.useState)(""),[c,o]=(0,l.useState)(!1),[x,m]=(0,l.useState)(null),[h,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=(await O.dw.getIntegrations()).find(e=>"TELEGRAM"===e.type);m(e)}catch(e){console.error(e)}},p=async()=>{if(n){o(!0);try{let e=await O.$z.setup(n);r("تم ربط بوت تيليجرام بنجاح"),m({isActive:!0,config:{botInfo:e.bot}}),g(!1),d("")}catch(e){r(e.message||"فشل الربط","error")}finally{o(!1)}}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"قنوات الاتصال"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"ربط البوت بتطبيقات المحادثة"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(R.Zb,{className:"border-l-4 border-l-green-500",children:[(0,t.jsx)(R.Ol,{children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-green-500/10 rounded-xl flex items-center justify-center text-green-600",children:(0,t.jsx)(u.Z,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(R.ll,{children:"WhatsApp Business"}),(0,t.jsx)(R.SZ,{children:"الرد الآلي على واتساب"})]})]}),(0,t.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full font-medium",children:"غير متصل"})]})}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-6",children:"اربط حساب واتساب للأعمال الخاص بك لتمكين الرد الآلي على استفسارات العملاء 24/7."}),(0,t.jsxs)(i.z,{className:"w-full bg-green-600 hover:bg-green-700",children:[(0,t.jsx)(ed.Z,{className:"w-4 h-4 ml-2"}),"ربط الحساب (QR Code)"]})]})]}),(0,t.jsxs)(R.Zb,{className:"border-l-4 ".concat((null==x?void 0:x.isActive)?"border-l-green-500":"border-l-blue-500"),children:[(0,t.jsx)(R.Ol,{children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center ".concat((null==x?void 0:x.isActive)?"bg-green-500/10 text-green-600":"bg-blue-500/10 text-blue-600"),children:(0,t.jsx)(f.Z,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(R.ll,{children:"Telegram Bot"}),(0,t.jsx)(R.SZ,{children:"الرد الآلي على تيليجرام"})]})]}),(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full font-medium ".concat((null==x?void 0:x.isActive)?"bg-green-100 text-green-600":"bg-red-100 text-red-600"),children:(null==x?void 0:x.isActive)?"متصل":"غير متصل"})]})}),(0,t.jsx)(R.aY,{children:(null==x?void 0:x.isActive)?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-100 dark:border-green-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(E.Z,{className:"w-5 h-5 text-green-600"}),(0,t.jsx)("span",{className:"font-bold text-green-700 dark:text-green-400",children:"البوت متصل بنجاح"})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["اسم البوت:"," ",(0,t.jsx)("span",{className:"font-mono font-bold",children:(null===(a=x.config)||void 0===a?void 0:null===(s=a.botInfo)||void 0===s?void 0:s.username)||"Unknown"})]})]}),(0,t.jsx)(i.z,{variant:"outline",className:"w-full text-red-500 hover:text-red-600 hover:bg-red-50",onClick:()=>{alert("لإلغاء الربط، يرجى التواصل مع الدعم الفني")},children:"إلغاء الربط"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-6",children:"أنشئ بوت على تيليجرام واربطه هنا للرد على المشتركين في قناتك أو مجموعتك."}),h?(0,t.jsxs)("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-xs font-medium",children:"Bot Token"}),(0,t.jsx)(el.I,{value:n,onChange:e=>d(e.target.value),placeholder:"123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11",className:"font-mono text-sm"}),(0,t.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"احصل عليه من @BotFather"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.z,{className:"flex-1 bg-blue-500 hover:bg-blue-600",onClick:p,disabled:c||!n,children:c?(0,t.jsx)(C.Z,{className:"animate-spin"}):"ربط الآن"}),(0,t.jsx)(i.z,{variant:"ghost",onClick:()=>g(!1),children:"إلغاء"})]})]}):(0,t.jsxs)(i.z,{className:"w-full bg-blue-500 hover:bg-blue-600",onClick:()=>g(!0),children:[(0,t.jsx)(ed.Z,{className:"w-4 h-4 ml-2"}),"إضافة توكن البوت"]})]})})]})]})]})}var eo=a(55421),ex=a(70699),em=a(97404),eh=a(37451),eu=a(50489),eg=a(10632),ej=a(18727);function ef(e){let{addNotification:s}=e,[a,r]=(0,l.useState)([]),[n,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(""),[m,h]=(0,l.useState)(""),[u,g]=(0,l.useState)(""),[j,f]=(0,l.useState)("text"),[b,v]=(0,l.useState)(!0),[y,N]=(0,l.useState)(null),[w,k]=(0,l.useState)(""),[S,Z]=(0,l.useState)("");(0,l.useEffect)(()=>{E()},[]);let E=async()=>{try{let e=await O.aS.list();r(e)}catch(e){console.error(e)}finally{v(!1)}},T=async e=>{let a=e.target.files[0];if(!a)return;d(!0);let t=new FormData;t.append("file",a);try{await O.aS.upload(t),s("تم رفع الملف بنجاح"),E(),e.target.value=null}catch(e){s("فشل الرفع: ".concat(e.message),"error")}finally{d(!1)}},D=async()=>{if(o){d(!0);try{await O.aS.addText({text:o,title:m}),s("تم إضافة النص بنجاح"),x(""),h(""),E()}catch(e){s("فشل: ".concat(e.message),"error")}finally{d(!1)}}},F=async()=>{if(u){d(!0);try{await O.aS.addUrl({url:u}),s("تم استجلاب الرابط بنجاح"),g(""),E()}catch(e){s("فشل: ".concat(e.message),"error")}finally{d(!1)}}},B=async e=>{if(confirm("هل أنت متأكد من الحذف؟"))try{await O.aS.delete(e),E(),s("تم الحذف بنجاح")}catch(e){s("فشل الحذف","error")}},Y=e=>{var s;N(e),k(e.content),Z((null===(s=e.metadata)||void 0===s?void 0:s.title)||"")},M=async()=>{if(w&&y){d(!0);try{await O.aS.update(y.id,{content:w,metadata:{...y.metadata,title:S}}),s("تم التحديث بنجاح"),N(null),k(""),Z(""),E()}catch(e){s("فشل التحديث: ".concat(e.message),"error")}finally{d(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[y&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:()=>N(null),children:(0,t.jsxs)(A.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:e=>e.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-3xl mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold flex items-center gap-2",children:[(0,t.jsx)(eo.Z,{className:"w-5 h-5 text-brand-500"}),"تعديل المصدر"]}),(0,t.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>N(null),children:(0,t.jsx)(c.Z,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"العنوان"}),(0,t.jsx)(el.I,{value:S,onChange:e=>Z(e.target.value),className:"bg-white dark:bg-gray-800 border-border text-gray-900 dark:text-white",placeholder:"عنوان المصدر"})]}),(0,t.jsxs)("div",{className:"space-y-2 flex-1 flex flex-col",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"المحتوى"}),(0,t.jsx)("textarea",{className:"w-full p-4 rounded-xl border border-border bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none text-sm leading-relaxed focus:ring-2 focus:ring-brand-500/20 outline-none min-h-[300px]",value:w,onChange:e=>k(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"p-6 border-t border-border flex gap-3",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:()=>N(null),className:"flex-1",children:"إلغاء"}),(0,t.jsxs)(i.z,{onClick:M,disabled:n||!w,className:"flex-1",children:[n?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):(0,t.jsx)(ex.Z,{className:"ml-2 w-4 h-4"}),"حفظ التعديلات"]})]})]})}),(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"grid grid-cols-1 lg:grid-cols-3 gap-8 h-[calc(100vh-140px)]",children:[(0,t.jsxs)(R.Zb,{className:"lg:col-span-1 flex flex-col h-full",children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(R.ll,{className:"text-lg",children:["المصادر النشطة (",a.length,")"]}),(0,t.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,t.jsx)(p.Z,{className:"w-4 h-4"})})]}),(0,t.jsx)(R.aY,{className:"flex-1 overflow-y-auto pr-2",children:b?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(C.Z,{className:"animate-spin"})}):(0,t.jsx)("div",{className:"space-y-3",children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground border-2 border-dashed border-border rounded-xl",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-muted rounded-full flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)(em.Z,{className:"w-6 h-6 text-muted-foreground"})}),(0,t.jsx)("p",{className:"font-medium",children:"قاعدة المعرفة فارغة"}),(0,t.jsx)("p",{className:"text-xs mt-1",children:"أضف نصوصاً أو روابط لتدريب البوت"})]}):a.map(e=>{var s,a,l;return(0,t.jsxs)("div",{className:"group flex items-center justify-between p-3 bg-card border border-border hover:border-brand-500/50 transition-all rounded-xl shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 overflow-hidden",children:[(0,t.jsxs)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ".concat("PDF"===e.type?"bg-red-500/10 text-red-500":"URL"===e.type?"bg-blue-500/10 text-blue-500":"bg-purple-500/10 text-purple-500"),children:["PDF"===e.type&&(0,t.jsx)(p.Z,{className:"w-5 h-5"}),"URL"===e.type&&(0,t.jsx)(eh.Z,{className:"w-5 h-5"}),"TEXT"===e.type&&(0,t.jsx)(p.Z,{className:"w-5 h-5"})]}),(0,t.jsxs)("div",{className:"truncate",children:[(0,t.jsx)("p",{className:"font-medium text-sm truncate max-w-[150px]",children:(null===(s=e.metadata)||void 0===s?void 0:s.filename)||(null===(a=e.metadata)||void 0===a?void 0:a.title)||(null===(l=e.metadata)||void 0===l?void 0:l.url)||"بدون عنوان"}),(0,t.jsx)("p",{className:"text-[10px] text-muted-foreground uppercase tracking-wider",children:e.type})]})]}),(0,t.jsxs)("div",{className:"flex gap-1",children:["TEXT"===e.type&&(0,t.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>Y(e),className:"opacity-0 group-hover:opacity-100 transition-opacity text-blue-500 hover:bg-blue-500/10",children:(0,t.jsx)(eo.Z,{className:"w-4 h-4"})}),(0,t.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>B(e.id),className:"opacity-0 group-hover:opacity-100 transition-opacity text-destructive hover:bg-destructive/10",children:(0,t.jsx)(eu.Z,{className:"w-4 h-4"})})]})]},e.id)})})})]}),(0,t.jsxs)(R.Zb,{className:"lg:col-span-2 flex flex-col h-full border-brand-500/20 shadow-lg",children:[(0,t.jsxs)("div",{className:"flex border-b border-border",children:[(0,t.jsxs)("button",{onClick:()=>f("text"),className:"flex-1 py-4 text-sm font-medium transition-all border-b-2 ".concat("text"===j?"border-brand-500 text-brand-500 bg-brand-500/5":"border-transparent text-muted-foreground hover:bg-muted/50"),children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 inline-block ml-2"}),"نص (Text)"]}),(0,t.jsxs)("button",{onClick:()=>f("url"),className:"flex-1 py-4 text-sm font-medium transition-all border-b-2 ".concat("url"===j?"border-brand-500 text-brand-500 bg-brand-500/5":"border-transparent text-muted-foreground hover:bg-muted/50"),children:[(0,t.jsx)(eh.Z,{className:"w-4 h-4 inline-block ml-2"}),"رابط (URL)"]}),(0,t.jsxs)("button",{onClick:()=>f("pdf"),className:"flex-1 py-4 text-sm font-medium transition-all border-b-2 ".concat("pdf"===j?"border-brand-500 text-brand-500 bg-brand-500/5":"border-transparent text-muted-foreground hover:bg-muted/50"),children:[(0,t.jsx)(eg.Z,{className:"w-4 h-4 inline-block ml-2"}),"ملف (PDF)"]})]}),(0,t.jsx)(R.aY,{className:"flex-1 p-6",children:(0,t.jsxs)(z.M,{mode:"wait",children:["text"===j&&(0,t.jsxs)(A.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4 h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"العنوان / الموضوع"}),(0,t.jsx)(el.I,{placeholder:"مثال: سياسة الاسترجاع",value:m,onChange:e=>h(e.target.value),className:"bg-white dark:bg-gray-800 border-border focus:bg-background transition-colors text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2 flex-1 flex flex-col",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"المحتوى"}),(0,t.jsx)("textarea",{className:"flex-1 w-full p-4 rounded-xl border border-border bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:bg-background transition-colors resize-none text-sm leading-relaxed focus:ring-2 focus:ring-brand-500/20 outline-none",placeholder:"الصق النص هنا... يمكنك إضافة معلومات عن عملك، الأسعار، الخدمات، أو أي شيء تريد أن يعرفه البوت.",value:o,onChange:e=>x(e.target.value)})]}),(0,t.jsxs)(i.z,{onClick:D,disabled:n||!o,className:"w-full h-12 text-lg shadow-lg shadow-brand-500/20",children:[n?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):(0,t.jsx)(ex.Z,{className:"ml-2 w-5 h-5"}),"حفظ المعلومات"]})]},"text"),"url"===j&&(0,t.jsxs)(A.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex flex-col justify-center h-full space-y-6 max-w-md mx-auto w-full",children:[(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(eh.Z,{className:"w-8 h-8"})}),(0,t.jsx)("h3",{className:"text-xl font-bold",children:"استجلاب من رابط"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"سيقوم البوت بزيارة الرابط وقراءة المحتوى ليتعلم منه."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(el.I,{placeholder:"https://example.com/about",value:u,onChange:e=>g(e.target.value),className:"h-12 text-center bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),(0,t.jsxs)(i.z,{onClick:F,disabled:n||!u,className:"w-full h-12",variant:"default",children:[n?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):(0,t.jsx)(ej.Z,{className:"ml-2 w-5 h-5"}),"بدء المعالجة"]})]}),(0,t.jsxs)("div",{className:"bg-yellow-500/10 p-4 rounded-lg text-xs text-yellow-600 dark:text-yellow-400 flex gap-2",children:[(0,t.jsx)(I.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,t.jsx)("p",{children:"تأكد من أن الرابط عام ويمكن الوصول إليه. الصفحات التي تتطلب تسجيل دخول لن تعمل."})]})]},"url"),"pdf"===j&&(0,t.jsx)(A.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex flex-col justify-center h-full space-y-6",children:(0,t.jsxs)("div",{className:"border-2 border-dashed border-brand-500/30 rounded-2xl p-12 text-center hover:bg-brand-500/5 transition-all cursor-pointer relative group",children:[(0,t.jsx)("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",onChange:T,accept:".pdf",disabled:n}),(0,t.jsx)("div",{className:"w-20 h-20 bg-brand-500/10 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform",children:n?(0,t.jsx)(C.Z,{className:"w-10 h-10 text-brand-500 animate-spin"}):(0,t.jsx)(eg.Z,{className:"w-10 h-10 text-brand-500"})}),(0,t.jsx)("h3",{className:"text-xl font-bold mb-2",children:"اسحب الملف هنا أو اضغط للرفع"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"ملفات PDF فقط (الحد الأقصى 10 ميجابايت)"}),(0,t.jsxs)("div",{className:"mt-6 flex justify-center gap-4",children:[(0,t.jsx)("span",{className:"px-3 py-1 bg-muted rounded-full text-xs",children:"Menu.pdf"}),(0,t.jsx)("span",{className:"px-3 py-1 bg-muted rounded-full text-xs",children:"Policy.pdf"}),(0,t.jsx)("span",{className:"px-3 py-1 bg-muted rounded-full text-xs",children:"Info.pdf"})]})]})},"pdf")]})})]})]})]})}var ep=a(70094);function eb(e){let{addNotification:s}=e,[a,r]=(0,l.useState)([]),[n,d]=(0,l.useState)(null),[c,o]=(0,l.useState)([]),[x,m]=(0,l.useState)({subject:"",message:"",priority:"MEDIUM"}),[h,u]=(0,l.useState)(""),[j,p]=(0,l.useState)(!1),[b,v]=(0,l.useState)(!0);(0,l.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await O.ch.list();r(e)}catch(e){console.error(e)}finally{v(!1)}},w=async e=>{e.preventDefault(),p(!0);try{await O.ch.create(x),s("تم إنشاء التذكرة بنجاح"),m({subject:"",message:"",priority:"MEDIUM"}),y(),d(null)}catch(e){s("فشل إنشاء التذكرة","error")}finally{p(!1)}},k=async e=>{d(e);try{let s=await O.ch.get(e.id);o(s.messages)}catch(e){console.error(e)}},S=async e=>{if(e.preventDefault(),h.trim())try{let e=await O.ch.reply(n.id,h);o(s=>[...s,e]),u("")}catch(e){s("فشل الإرسال","error")}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"grid grid-cols-1 lg:grid-cols-3 gap-8 h-[calc(100vh-140px)]",children:[(0,t.jsxs)(R.Zb,{className:"lg:col-span-1 flex flex-col h-full",children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsx)(R.ll,{children:"تذاكر الدعم"}),(0,t.jsx)(R.SZ,{children:"تواصل مع فريق الدعم الفني"})]}),(0,t.jsxs)(R.aY,{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(0,t.jsxs)(i.z,{className:"w-full mb-4",onClick:()=>d(null),children:[(0,t.jsx)(ep.Z,{className:"w-4 h-4 ml-2"})," تذكرة جديدة"]}),b?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(C.Z,{className:"animate-spin"})}):0===a.length?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"لا توجد تذاكر"}):a.map(e=>(0,t.jsxs)("div",{onClick:()=>k(e),className:"p-4 rounded-lg cursor-pointer border transition-all ".concat((null==n?void 0:n.id)===e.id?"bg-brand-500/10 border-brand-500":"bg-card hover:bg-muted border-border"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsx)("h4",{className:"font-bold text-sm truncate",children:e.subject}),(0,t.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full ".concat("OPEN"===e.status?"bg-green-100 text-green-700":"IN_PROGRESS"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.status})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:new Date(e.updatedAt).toLocaleDateString("ar-SA")}),(0,t.jsx)("span",{className:"font-medium ".concat("URGENT"===e.priority?"text-red-500":""),children:e.priority})]})]},e.id))]})]}),(0,t.jsx)(R.Zb,{className:"lg:col-span-2 flex flex-col h-full",children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Ol,{className:"border-b py-4 bg-muted/30",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(R.ll,{className:"text-lg",children:n.subject}),(0,t.jsxs)(R.SZ,{children:["تذكرة #",n.id.slice(-4)]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat("OPEN"===n.status?"bg-green-100 text-green-700":"IN_PROGRESS"===n.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:n.status})})]})}),(0,t.jsx)(R.aY,{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-muted/10",children:c.map((e,s)=>{var a;return(0,t.jsxs)("div",{className:"flex gap-4 ".concat(e.isAdmin?"flex-row-reverse":""),children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm ".concat(e.isAdmin?"bg-brand-600 text-white":"bg-white dark:bg-gray-700"),children:e.isAdmin?(0,t.jsx)(g.Z,{className:"w-5 h-5"}):(0,t.jsx)(N.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex-1 max-w-[80%] space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 ".concat(e.isAdmin?"flex-row-reverse":""),children:[(0,t.jsx)("span",{className:"text-xs font-bold",children:(null===(a=e.sender)||void 0===a?void 0:a.name)||(e.isAdmin?"الدعم الفني":"أنت")}),(0,t.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(e.createdAt).toLocaleString("ar-SA")})]}),(0,t.jsx)("div",{className:"p-4 rounded-xl shadow-sm text-sm leading-relaxed ".concat(e.isAdmin?"bg-brand-600 text-white rounded-tr-none":"bg-white dark:bg-gray-800 border border-border rounded-tl-none"),children:e.message})]})]},s)})}),(0,t.jsx)(R.eW,{className:"border-t p-4 bg-background",children:(0,t.jsxs)("form",{onSubmit:S,className:"flex w-full gap-3",children:[(0,t.jsx)(el.I,{value:h,onChange:e=>u(e.target.value),placeholder:"اكتب ردك هنا...",className:"flex-1 bg-muted/50",disabled:"CLOSED"===n.status}),(0,t.jsxs)(i.z,{type:"submit",disabled:!h.trim()||"CLOSED"===n.status,children:[(0,t.jsx)(f.Z,{className:"w-4 h-4 ml-2"})," إرسال"]})]})})]}):(0,t.jsxs)("div",{className:"p-6 h-full flex flex-col",children:[(0,t.jsx)("h3",{className:"text-xl font-bold mb-6",children:"إنشاء تذكرة جديدة"}),(0,t.jsxs)("form",{onSubmit:w,className:"space-y-4 flex-1",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"الموضوع"}),(0,t.jsx)(el.I,{required:!0,value:x.subject,onChange:e=>m({...x,subject:e.target.value}),placeholder:"عنوان المشكلة",className:"bg-white dark:bg-gray-800"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"الأولوية"}),(0,t.jsxs)("select",{className:"flex h-10 w-full rounded-md border border-input bg-white dark:bg-gray-800 px-3 py-2 text-sm",value:x.priority,onChange:e=>m({...x,priority:e.target.value}),children:[(0,t.jsx)("option",{value:"LOW",children:"منخفضة"}),(0,t.jsx)("option",{value:"MEDIUM",children:"متوسطة"}),(0,t.jsx)("option",{value:"HIGH",children:"عالية"}),(0,t.jsx)("option",{value:"URGENT",children:"عاجلة"})]})]}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"تفاصيل المشكلة"}),(0,t.jsx)("textarea",{required:!0,className:"flex min-h-[200px] w-full rounded-md border border-input bg-white dark:bg-gray-800 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:x.message,onChange:e=>m({...x,message:e.target.value}),placeholder:"اشرح مشكلتك بالتفصيل..."})]}),(0,t.jsx)(i.z,{type:"submit",className:"w-full",disabled:j,children:j?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):"إرسال التذكرة"})]})]})})]})}var ev=a(93151),ey=a(93605);function eN(e){let{user:s,addNotification:a,setShowProAlert:r}=e,[n,d]=(0,l.useState)({welcomeMessage:"",primaryColor:"#000000",personality:"friendly",showBranding:!0,avatar:"robot"}),[c,o]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(null==s?void 0:s.businessId)&&x(s.businessId)},[s]);let x=async e=>{try{let s=await O.c_.getConfig(e);d(e=>({...e,...(null==s?void 0:s.widgetConfig)||{}}))}catch(e){console.error(e)}},m=async()=>{o(!0);try{await O.c_.updateConfig(n),a("تم حفظ الإعدادات")}catch(e){a("فشل الحفظ","error")}finally{o(!1)}},h=async e=>{let s=e.target.files[0];if(!s)return;let t=new FormData;t.append("icon",s);try{let e=await O.c_.uploadIcon(t);d(s=>({...s,customIconUrl:e.url,avatar:"custom"})),a("تم رفع الأيقونة بنجاح")}catch(e){a("فشل رفع الأيقونة","error")}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"إعدادات المظهر والسلوك"})}),(0,t.jsxs)(R.aY,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"رسالة الترحيب"}),(0,t.jsx)(el.I,{value:n.welcomeMessage,onChange:e=>d({...n,welcomeMessage:e.target.value}),placeholder:"أهلاً بك! كيف يمكنني مساعدتك؟",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"اللون الرئيسي"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(el.I,{type:"color",value:n.primaryColor,onChange:e=>d({...n,primaryColor:e.target.value}),className:"w-12 h-10 p-1 cursor-pointer bg-white dark:bg-gray-800"}),(0,t.jsx)(el.I,{value:n.primaryColor,onChange:e=>d({...n,primaryColor:e.target.value}),className:"flex-1 bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"أيقونة البوت"}),(0,t.jsxs)("div",{className:"grid grid-cols-6 gap-3",children:[[{id:"robot",icon:er.Z,label:"Robot"},{id:"support",icon:g.Z,label:"Support"},{id:"chat",icon:u.Z,label:"Chat"},{id:"sparkles",icon:ej.Z,label:"AI"},{id:"business",icon:ev.Z,label:"Business"},{id:"user",icon:N.Z,label:"Agent"}].map(e=>(0,t.jsx)("div",{onClick:()=>d({...n,avatar:e.id}),className:"aspect-square rounded-xl flex items-center justify-center cursor-pointer border-2 transition-all hover:scale-105 ".concat(n.avatar===e.id?"border-brand-500 bg-brand-500/10 shadow-lg shadow-brand-500/20 text-brand-500":"border-border hover:bg-muted dark:hover:bg-gray-700 text-muted-foreground dark:text-gray-300 hover:text-foreground dark:hover:text-white"),title:e.label,children:(0,t.jsx)(e.icon,{className:"w-6 h-6"})},e.id)),(0,t.jsxs)("div",{className:"aspect-square rounded-xl border-2 border-dashed border-border hover:border-brand-500 hover:bg-muted flex items-center justify-center cursor-pointer transition-all group overflow-hidden relative",children:[(0,t.jsx)("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",onChange:h,accept:"image/*"}),"custom"===n.avatar&&n.customIconUrl?(0,t.jsx)("img",{src:n.customIconUrl,alt:"Custom",className:"w-full h-full object-cover"}):(0,t.jsx)(eg.Z,{className:"w-6 h-6 text-muted-foreground group-hover:text-brand-500"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"شخصية البوت"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["formal","friendly","fun"].map(e=>(0,t.jsxs)("div",{onClick:()=>d({...n,personality:e}),className:"cursor-pointer border rounded-lg p-3 text-center transition-all ".concat(n.personality===e?"border-brand-500 bg-brand-500/10 ring-2 ring-brand-500/20 text-brand-500":"border-border hover:bg-muted dark:hover:bg-gray-700 text-muted-foreground dark:text-gray-300 hover:text-foreground dark:hover:text-white"),children:[(0,t.jsxs)("div",{className:"text-2xl mb-1",children:["formal"===e&&"\uD83D\uDC54","friendly"===e&&"\uD83D\uDE0A","fun"===e&&"\uD83E\uDD2A"]}),(0,t.jsxs)("div",{className:"text-xs font-medium",children:["formal"===e&&"رسمي","friendly"===e&&"ودود","fun"===e&&"مرح"]})]},e))})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:'علامة "مدعوم من فهيم"'}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"إظهار شعار فهيم في أسفل الويدجت (متاح فقط في الباقة الاحترافية)"})]}),(0,t.jsx)("input",{type:"checkbox",checked:n.showBranding,onChange:e=>{if((null==s?void 0:s.planType)!=="PRO"&&(null==s?void 0:s.planType)!=="ENTERPRISE"&&(null==s?void 0:s.planType)!=="AGENCY"){r(!0);return}d({...n,showBranding:e.target.checked})},className:"toggle"})]}),(0,t.jsxs)(i.z,{onClick:m,disabled:c,className:"w-full",children:[c?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):(0,t.jsx)(ex.Z,{className:"ml-2 w-4 h-4"}),"حفظ الإعدادات"]})]})]}),(0,t.jsxs)(R.Zb,{className:"overflow-hidden border-2 border-dashed",children:[(0,t.jsx)(R.Ol,{className:"bg-muted/50 pb-4",children:(0,t.jsx)(R.ll,{className:"text-sm text-center text-muted-foreground",children:"معاينة حية"})}),(0,t.jsx)(R.aY,{className:"p-0 h-[500px] relative bg-white dark:bg-gray-900 flex items-end justify-end p-6",children:(0,t.jsxs)("div",{className:"w-[350px] h-[450px] bg-background rounded-2xl shadow-2xl border border-border flex flex-col overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 text-white flex items-center gap-3",style:{backgroundColor:n.primaryColor||ey.cg.brand500},children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center overflow-hidden text-lg",children:"custom"===n.avatar&&n.customIconUrl?(0,t.jsx)("img",{src:n.customIconUrl,alt:"Bot",className:"w-full h-full object-cover"}):(()=>{let e={robot:er.Z,support:g.Z,chat:u.Z,sparkles:ej.Z,business:ev.Z,user:N.Z}[n.avatar]||er.Z;return(0,t.jsx)(e,{className:"w-5 h-5 text-white"})})()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-sm",children:"مساعدك الذكي"}),(0,t.jsx)("p",{className:"text-xs opacity-80",children:"متصل الآن"})]})]}),(0,t.jsx)("div",{className:"flex-1 p-4 bg-muted/30 space-y-4 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex-shrink-0"}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg rounded-tr-none shadow-sm text-sm max-w-[80%]",children:n.welcomeMessage||"مرحباً! كيف يمكنني مساعدتك اليوم؟"})]})}),(0,t.jsxs)("div",{className:"p-3 border-t bg-background",children:[(0,t.jsx)("div",{className:"h-10 bg-muted rounded-full w-full"}),n.showBranding&&(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsxs)("span",{className:"text-[10px] text-gray-400",children:["Powered by ",(0,t.jsx)("span",{className:"font-bold",children:"فهملي.كوم"})]})})]})]})})]})]})}function ew(e){let{addNotification:s}=e,[a,r]=(0,l.useState)([]),[n,d]=(0,l.useState)({name:"",email:"",password:""}),[c,o]=(0,l.useState)(!1),[x,m]=(0,l.useState)(!0);(0,l.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await O.v1.list();r(e)}catch(e){console.error(e)}finally{m(!1)}},u=async e=>{e.preventDefault(),o(!0);try{await O.v1.add(n),s("تم إضافة الموظف بنجاح"),d({name:"",email:"",password:""}),h()}catch(e){s(e.message||"فشل الإضافة","error")}finally{o(!1)}},g=async e=>{if(confirm("هل أنت متأكد من حذف هذا الموظف؟"))try{await O.v1.delete(e),s("تم الحذف بنجاح"),h()}catch(e){s("فشل الحذف","error")}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"فريق العمل"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"إدارة موظفي خدمة العملاء والصلاحيات"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,t.jsxs)(R.Zb,{className:"md:col-span-1 h-fit",children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsx)(R.ll,{children:"إضافة موظف جديد"}),(0,t.jsx)(R.SZ,{children:"سيتم إرسال بيانات الدخول للموظف"})]}),(0,t.jsx)(R.aY,{children:(0,t.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"الاسم"}),(0,t.jsx)(el.I,{required:!0,value:n.name,onChange:e=>d({...n,name:e.target.value}),placeholder:"اسم الموظف",className:"bg-white dark:bg-gray-800"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"البريد الإلكتروني"}),(0,t.jsx)(el.I,{required:!0,type:"email",value:n.email,onChange:e=>d({...n,email:e.target.value}),placeholder:"email@example.com",className:"bg-white dark:bg-gray-800"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"كلمة المرور"}),(0,t.jsx)(el.I,{required:!0,type:"password",value:n.password,onChange:e=>d({...n,password:e.target.value}),placeholder:"******",className:"bg-white dark:bg-gray-800"})]}),(0,t.jsxs)(i.z,{type:"submit",className:"w-full",disabled:c,children:[c?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):(0,t.jsx)(N.Z,{className:"ml-2 w-4 h-4"}),"إضافة الموظف"]})]})})]}),(0,t.jsxs)(R.Zb,{className:"md:col-span-2",children:[(0,t.jsx)(R.Ol,{children:(0,t.jsxs)(R.ll,{children:["الموظفين الحاليين (",a.length,")"]})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"space-y-4",children:x?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(C.Z,{className:"animate-spin"})}):0===a.length?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"لا يوجد موظفين حالياً"}):a.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card hover:bg-muted/50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-brand-500/10 flex items-center justify-center text-brand-500 font-bold",children:e.name[0]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-bold",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-sm text-right hidden sm:block",children:[(0,t.jsx)("div",{className:"font-bold text-brand-500",children:"AGENT"}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["منذ"," ",new Date(e.createdAt).toLocaleDateString("ar-SA")]})]}),(0,t.jsx)(i.z,{variant:"ghost",size:"icon",className:"text-destructive hover:bg-destructive/10",onClick:()=>g(e.id),children:(0,t.jsx)(eu.Z,{className:"w-4 h-4"})})]})]},e.id))})})]})]})]})}function ek(e){let{user:s,addNotification:a}=e,[r,n]=(0,l.useState)({name:"",email:"",password:""}),[d,c]=(0,l.useState)({name:"",activityType:"",botTone:""}),[o,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{s&&(n({name:s.name,email:s.email,password:""}),m())},[s]);let m=async()=>{try{let e=await O.dw.getSettings();e&&c({name:e.name,activityType:e.activityType,botTone:e.botTone})}catch(e){console.error(e)}},h=async e=>{e.preventDefault(),x(!0);try{let e=await O.iJ.updateProfile(r);await O.dw.updateSettings(d),a("تم تحديث البيانات بنجاح");let s=JSON.parse(localStorage.getItem("user"));localStorage.setItem("user",JSON.stringify({...s,...e.user}))}catch(e){a("حدث خطأ أثناء التحديث: "+e.message,"error")}finally{x(!1)}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsx)(R.ll,{children:"الملف الشخصي"}),(0,t.jsx)(R.SZ,{children:"تحديث بيانات حسابك الشخصي"})]}),(0,t.jsxs)(R.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"الاسم"}),(0,t.jsx)(el.I,{value:r.name,onChange:e=>n({...r,name:e.target.value}),className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"البريد الإلكتروني"}),(0,t.jsx)(el.I,{value:r.email,onChange:e=>n({...r,email:e.target.value}),className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"كلمة المرور الجديدة"}),(0,t.jsx)(el.I,{type:"password",placeholder:"اتركه فارغاً إذا لم ترد التغيير",value:r.password,onChange:e=>n({...r,password:e.target.value}),className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{children:[(0,t.jsx)(R.ll,{children:"بيانات النشاط التجاري"}),(0,t.jsx)(R.SZ,{children:"تحديث معلومات شركتك أو مطعمك"})]}),(0,t.jsxs)(R.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"اسم النشاط"}),(0,t.jsx)(el.I,{value:d.name,onChange:e=>c({...d,name:e.target.value}),className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"نوع النشاط"}),(0,t.jsxs)("select",{className:"flex h-10 w-full rounded-md border border-input bg-white dark:bg-gray-800 px-3 py-2 text-sm text-gray-900 dark:text-white",value:d.activityType,onChange:e=>c({...d,activityType:e.target.value}),children:[(0,t.jsx)("option",{value:"RESTAURANT",children:"مطعم"}),(0,t.jsx)("option",{value:"RETAIL",children:"متجر تجزئة"}),(0,t.jsx)("option",{value:"CLINIC",children:"عيادة"}),(0,t.jsx)("option",{value:"COMPANY",children:"شركة"}),(0,t.jsx)("option",{value:"OTHER",children:"أخرى"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"نبرة البوت الافتراضية"}),(0,t.jsxs)("select",{className:"flex h-10 w-full rounded-md border border-input bg-white dark:bg-gray-800 px-3 py-2 text-sm text-gray-900 dark:text-white",value:d.botTone,onChange:e=>c({...d,botTone:e.target.value}),children:[(0,t.jsx)("option",{value:"friendly",children:"ودود"}),(0,t.jsx)("option",{value:"formal",children:"رسمي"}),(0,t.jsx)("option",{value:"funny",children:"مرح"}),(0,t.jsx)("option",{value:"empathetic",children:"متعاطف"})]})]})]}),(0,t.jsx)(R.eW,{children:(0,t.jsxs)(i.z,{onClick:h,disabled:o,className:"w-full",children:[o?(0,t.jsx)(C.Z,{className:"animate-spin ml-2"}):(0,t.jsx)(ex.Z,{className:"ml-2 w-4 h-4"}),"حفظ التغييرات"]})})]})]})}var eS=a(79990);function eZ(){let[e,s]=(0,l.useState)([{role:"assistant",content:"مرحباً! أنا مساعدك الذكي. جرّب التحدث معي الآن!"}]),[a,r]=(0,l.useState)(""),[n,d]=(0,l.useState)(!1),c=(0,l.useRef)(null),o=()=>{var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,l.useEffect)(()=>{o()},[e]);let x=async()=>{if(!a.trim()||n)return;let e=a.trim();r(""),s(s=>[...s,{role:"user",content:e}]),d(!0);try{let a=localStorage.getItem("token"),t=await fetch("".concat("http://localhost:3001","/api/chat/test"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({message:e})}),l=await t.json();t.ok?s(e=>[...e,{role:"assistant",content:l.response||"عذراً، لم أستطع الرد في الوقت الحالي."}]):s(e=>[...e,{role:"assistant",content:"عذراً، حدث خطأ في الاتصال. يرجى المحاولة مرة أخرى."}])}catch(e){console.error("Playground error:",e),s(e=>[...e,{role:"assistant",content:"عذراً، حدث خطأ في الاتصال. يرجى التأكد من إعداداتك."}])}finally{d(!1)}};return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"h-full flex flex-col",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-t-2xl p-6 mb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-brand-500 to-purple-600 flex items-center justify-center",children:(0,t.jsx)(er.Z,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:["تجربة البوت المباشرة",(0,t.jsx)(ej.Z,{className:"w-5 h-5 text-yellow-500"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"جرّب محادثة البوت الخاص بك وشاهد كيف يرد على العملاء"})]})]})}),(0,t.jsxs)("div",{className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl overflow-hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-gray-50 dark:bg-gray-900",children:[(0,t.jsx)(z.M,{children:e.map((e,s)=>(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3 ".concat("user"===e.role?"flex-row-reverse":"flex-row"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat("user"===e.role?"bg-brand-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"user"===e.role?(0,t.jsx)(N.Z,{size:16}):(0,t.jsx)(er.Z,{size:16})}),(0,t.jsx)("div",{className:"max-w-[70%] rounded-2xl px-4 py-3 ".concat("user"===e.role?"bg-brand-600 text-white rounded-br-none":"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-bl-none"),children:(0,t.jsx)("p",{className:"text-sm leading-relaxed",children:e.content})})]},s))}),n&&(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:(0,t.jsx)(er.Z,{size:16})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl rounded-bl-none px-4 py-3",children:(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,t.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-100"}),(0,t.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-200"})]})})]}),(0,t.jsx)("div",{ref:c})]}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:a,onChange:e=>r(e.target.value),onKeyDown:e=>"Enter"===e.key&&x(),placeholder:"اكتب رسالتك هنا...",disabled:n,className:"flex-1 px-4 py-3 rounded-full border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-brand-500 disabled:opacity-50"}),(0,t.jsx)(i.z,{onClick:x,disabled:!a.trim()||n,className:"rounded-full w-12 h-12 p-0 flex items-center justify-center",children:n?(0,t.jsx)(C.Z,{className:"w-5 h-5 animate-spin"}):(0,t.jsx)(eS.Z,{className:"w-5 h-5"})})]})})]})]})}var eC=a(37841),eE=a(75879),eI=a(90043),eT=a(63013),eD=a(62457);function ez(){var e,s,a;let[r,n]=(0,l.useState)([]),[i,d]=(0,l.useState)(null),[c,o]=(0,l.useState)(null),[x,m]=(0,l.useState)(!0),[h,u]=(0,l.useState)("7d");(0,l.useEffect)(()=>{g();let e=setInterval(j,3e4);return()=>clearInterval(e)},[h]);let g=async()=>{await Promise.all([j(),f(),p()]),m(!1)},j=async()=>{try{let e=localStorage.getItem("token"),s=await fetch("/api/visitor/active-sessions",{headers:{Authorization:"Bearer ".concat(e)}}),a=await s.json();a.success&&n(a.sessions)}catch(e){console.error("Error fetching active sessions:",e)}},f=async()=>{try{let e=localStorage.getItem("token"),s=b(h),a=await fetch("/api/visitor/analytics?from=".concat(s.toISOString()),{headers:{Authorization:"Bearer ".concat(e)}}),t=await a.json();t.success&&d(t.analytics)}catch(e){console.error("Error fetching analytics:",e)}},p=async()=>{try{var e,s;localStorage.getItem("token");let a=JSON.parse(localStorage.getItem("user")||"{}"),t=null===(s=a.businesses)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.id;if(!t)return;let l=await fetch("/api/rating/stats/".concat(t)),r=await l.json();r.success&&o(r.stats)}catch(e){console.error("Error fetching rating stats:",e)}},b=e=>{let s=new Date;switch(e){case"7d":default:return new Date(s-6048e5);case"30d":return new Date(s-2592e6);case"90d":return new Date(s-7776e6)}};return x?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-500"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex gap-2",children:["7d","30d","90d"].map(e=>(0,t.jsx)("button",{onClick:()=>u(e),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(h===e?"bg-brand-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:"7d"===e?"آخر 7 أيام":"30d"===e?"آخر 30 يوم":"آخر 90 يوم"},e))}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"إجمالي الجلسات"}),(0,t.jsx)(eC.Z,{className:"w-4 h-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(null==i?void 0:i.totalSessions)||0}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[r.length," نشط الآن"]})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"مشاهدات الصفحات"}),(0,t.jsx)(eh.Z,{className:"w-4 h-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(null==i?void 0:i.totalPageViews)||0}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==i?void 0:i.totalPageViews)&&(null==i?void 0:i.totalSessions)?(i.totalPageViews/i.totalSessions).toFixed(1):0," ","لكل جلسة"]})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"متوسط المدة"}),(0,t.jsx)(Y.Z,{className:"w-4 h-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(a=Math.floor((null==i?void 0:i.avgDuration)||0),"".concat(Math.floor(a/60),"د ").concat(a%60,"ث"))}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"لكل جلسة"})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsxs)(R.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,t.jsx)(R.ll,{className:"text-sm font-medium",children:"التقييم"}),(0,t.jsx)(eE.Z,{className:"w-4 h-4 text-muted-foreground"})]}),(0,t.jsxs)(R.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold flex items-center gap-1",children:[(null==c?void 0:null===(e=c.avgRating)||void 0===e?void 0:e.toFixed(1))||0,(0,t.jsx)(eE.Z,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"})]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["من ",(null==c?void 0:c.totalRatings)||0," تقييم"]})]})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsxs)(R.ll,{children:["الزوار النشطون (",r.length,")"]})}),(0,t.jsx)(R.aY,{children:0===r.length?(0,t.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"لا يوجد زوار نشطون حالياً"}):(0,t.jsx)("div",{className:"space-y-4",children:r.map(e=>{var s,a;return(0,t.jsxs)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-brand-500/10 rounded-full",children:e.isMobile?(0,t.jsx)(eI.Z,{className:"w-5 h-5 text-brand-500"}):(0,t.jsx)(eT.Z,{className:"w-5 h-5 text-brand-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eD.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.city||"Unknown",","," ",e.country||"Unknown"]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.browser," • ",e.os]})]})]}),(0,t.jsxs)("div",{className:"text-left",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(eC.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:[e.pageViews," صفحة"]})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:(null===(a=e.pageVisits)||void 0===a?void 0:null===(s=a[0])||void 0===s?void 0:s.path)||"/"})]})]},e.id)})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"حسب الجهاز"})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:Object.entries((null==i?void 0:i.byDevice)||{}).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"capitalize",children:s}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-32 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-brand-500",style:{width:"".concat(a/i.totalSessions*100,"%")}})}),(0,t.jsx)("span",{className:"text-sm font-medium",children:a})]})]},s)})})})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"حسب المتصفح"})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:Object.entries((null==i?void 0:i.byBrowser)||{}).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:s}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-32 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-brand-500",style:{width:"".concat(a/i.totalSessions*100,"%")}})}),(0,t.jsx)("span",{className:"text-sm font-medium",children:a})]})]},s)})})})]})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"الصفحات الأكثر زيارة"})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:null==i?void 0:null===(s=i.topPages)||void 0===s?void 0:s.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-brand-500/10 rounded text-xs font-bold text-brand-500",children:s+1}),(0,t.jsx)("span",{className:"font-mono text-sm",children:e.path})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e.count," زيارة"]})]},e.path))})})]}),(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"مصادر الزيارات"})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries((null==i?void 0:i.trafficSources)||{}).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-brand-500",children:a}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground capitalize",children:s})]},s)})})})]}),c&&(0,t.jsxs)(R.Zb,{children:[(0,t.jsx)(R.Ol,{children:(0,t.jsx)(R.ll,{children:"توزيع التقييمات"})}),(0,t.jsx)(R.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:[5,4,3,2,1].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 w-20",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:e}),(0,t.jsx)(eE.Z,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"})]}),(0,t.jsx)("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-yellow-400",style:{width:"".concat((c.ratingDistribution[e]||0)/c.totalRatings*100,"%")}})}),(0,t.jsx)("span",{className:"text-sm font-medium w-12 text-left",children:c.ratingDistribution[e]||0})]},e))})})]})]})}var eA=a(56444);let eO=[{target:"#dashboard-overview",content:"\uD83D\uDC4B مرحباً بك في لوحة التحكم! دعنا نأخذك في جولة سريعة للتعرف على المميزات الأساسية.",placement:"center",disableBeacon:!0,locale:{skip:"تخطي",next:"التالي",back:"السابق",last:"إنهاء"}},{target:'[data-tour="stats-overview"]',content:"\uD83D\uDCCA هنا تجد ملخص إحصائياتك: عدد المحادثات، معدل الرضا، وأداء البوت.",placement:"bottom"},{target:'[data-tour="sidebar-conversations"]',content:"\uD83D\uDCAC قسم المحادثات: اطلع على جميع محادثات العملاء مع البوت.",placement:"left"},{target:'[data-tour="sidebar-knowledge"]',content:"\uD83D\uDCDA قاعدة المعرفة: أضف ملفات، نصوص، أو روابط لتدريب البوت.",placement:"left"},{target:'[data-tour="sidebar-widget"]',content:"\uD83C\uDFA8 إعدادات الويدجت: خصص الألوان، الرسائل، وشكل البوت.",placement:"left"},{target:'[data-tour="sidebar-settings"]',content:"⚙️ الإعدادات: أدر اشتراكك، الفريق، والتكاملات.",placement:"left"},{target:'[data-tour="theme-toggle"]',content:"\uD83C\uDF19 يمكنك التبديل بين الوضع الليلي والنهاري من هنا.",placement:"bottom"},{target:"body",content:"\uD83C\uDF89 رائع! أنت الآن جاهز للبدء. يمكنك دائماً إعادة الجولة من قائمة المساعدة.",placement:"center"}];function eF(e){let{run:s,onComplete:a}=e,[r,n]=(0,l.useState)(0);return(0,t.jsx)(eA.ZP,{steps:eO,run:s,continuous:!0,showProgress:!0,showSkipButton:!0,stepIndex:r,callback:e=>{let{action:s,index:t,status:l,type:r}=e;[eA.FP.STEP_AFTER,eA.FP.TARGET_NOT_FOUND].includes(r)?n(t+(s===eA.aO.PREV?-1:1)):[eA.Q_.FINISHED,eA.Q_.SKIPPED].includes(l)&&(n(0),l===eA.Q_.FINISHED&&(localStorage.setItem("dashboardTourCompleted","true"),localStorage.setItem("dashboardTourCompletedAt",new Date().toISOString())),a&&a(l===eA.Q_.FINISHED))},styles:{options:{arrowColor:"#fff",backgroundColor:"#fff",primaryColor:"#4F46E5",textColor:"#1F2937",overlayColor:"rgba(0, 0, 0, 0.5)",zIndex:1e4},tooltip:{fontSize:"15px",padding:"20px",borderRadius:"12px"},tooltipContainer:{textAlign:"right"},buttonNext:{backgroundColor:"#4F46E5",fontSize:"14px",padding:"10px 20px",borderRadius:"8px",fontWeight:"600"},buttonBack:{color:"#6B7280",fontSize:"14px",marginLeft:"10px"},buttonSkip:{color:"#9CA3AF",fontSize:"13px"},beacon:{inner:"#4F46E5",outer:"#4F46E5"}},locale:{back:"السابق",close:"إغلاق",last:"إنهاء",next:"التالي",open:"فتح",skip:"تخطي"},floaterProps:{disableAnimation:!1,styles:{arrow:{length:8,spread:16}}}})}function eR(){var e;let[s,a]=(0,l.useState)(null),[o,h]=(0,l.useState)(null),[u,g]=(0,l.useState)([]),[j,f]=(0,l.useState)([]),[p,b]=(0,l.useState)(!0),[v,y]=(0,l.useState)(null),[N,w]=(0,l.useState)("overview"),[k,F]=(0,r.ZP)(!1),[R,B]=(0,l.useState)(!1),[Y,M]=(0,l.useState)([]),{runTour:P,startTour:U,resetTour:L,handleComplete:_}=function(){let[e,s]=(0,l.useState)(!1),[a,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=localStorage.getItem("dashboardTourCompleted"),a=!localStorage.getItem("hasVisitedDashboard");!e&&a&&setTimeout(()=>{s(!0)},1e3),localStorage.setItem("hasVisitedDashboard","true"),t(!!e)},[]),{runTour:e,tourCompleted:a,startTour:()=>s(!0),stopTour:()=>s(!1),resetTour:()=>{localStorage.removeItem("dashboardTourCompleted"),localStorage.removeItem("dashboardTourCompletedAt"),t(!1),s(!0)},handleComplete:e=>{s(!1),t(e)}}}(),K=(0,n.useRouter)();(0,l.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{y(JSON.parse(e))}catch(e){console.error("Error parsing user data",e)}q()},[]);let q=async()=>{try{let[e,s,t]=await Promise.all([O.dw.getStats(),O.aS.list(),O.dw.getChartData()]);a(e.stats),h(e.subscription),g(s),f(t)}catch(e){console.error("Failed to fetch dashboard data",e),e.message&&e.message.includes("401")&&K.push("/login")}finally{b(!1)}},W=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=Date.now();M(t=>[...t,{id:a,message:e,type:s}]),setTimeout(()=>{M(e=>e.filter(e=>e.id!==a))},3e3)};return p?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background text-foreground",children:(0,t.jsx)(C.Z,{className:"w-10 h-10 animate-spin text-brand-500"})}):(0,t.jsxs)("div",{className:"min-h-screen font-sans overflow-x-hidden relative selection:bg-brand-500/30 transition-colors duration-500 bg-gray-50 dark:bg-cosmic-950 text-gray-900 dark:text-white flex flex-col md:flex-row",dir:"rtl",children:[(0,t.jsxs)("div",{className:"fixed inset-0 pointer-events-none overflow-hidden -z-10",children:[(0,t.jsx)("div",{className:"absolute top-[-10%] left-[-10%] w-[50vw] h-[50vw] bg-brand-600/8 rounded-full blur-[120px] animate-pulse-slow"}),(0,t.jsx)("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40vw] h-[40vw] bg-purple-600/8 rounded-full blur-[120px] animate-float"})]}),(0,t.jsx)(d.Z,{activeTab:N,setActiveTab:w,userRole:null==v?void 0:v.role}),(0,t.jsx)(Z,{activeTab:N,setActiveTab:w,userRole:null==v?void 0:v.role}),(0,t.jsx)("div",{className:"fixed top-4 left-4 z-50 flex flex-col gap-2",children:(0,t.jsx)(z.M,{children:Y.map(e=>(0,t.jsxs)(A.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"p-4 rounded-lg shadow-lg text-white flex items-center gap-2 min-w-[300px] ".concat("success"===e.type?"bg-green-600":"bg-red-600"),children:["success"===e.type?(0,t.jsx)(E.Z,{className:"w-5 h-5"}):(0,t.jsx)(I.Z,{className:"w-5 h-5"}),e.message]},e.id))})}),(0,t.jsxs)("main",{className:"flex-1 p-4 md:p-8 overflow-y-auto h-screen relative pt-16 md:pt-8",children:[(0,t.jsx)(z.M,{children:R&&(0,t.jsx)(A.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:(0,t.jsxs)(A.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-card border border-brand-500/20 w-full max-w-md rounded-xl shadow-2xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-brand-500/20 to-brand-500/5 p-6 text-center relative",children:[(0,t.jsx)(i.z,{variant:"ghost",size:"icon",className:"absolute top-2 right-2",onClick:()=>B(!1),children:(0,t.jsx)(c.Z,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"w-16 h-16 bg-brand-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(T.Z,{className:"w-8 h-8 text-brand-500"})}),(0,t.jsx)("h3",{className:"text-xl font-bold mb-2",children:"ميزة احترافية"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"هذه الميزة متاحة فقط في الباقة الاحترافية"})]}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(E.Z,{className:"w-5 h-5 text-green-500"}),(0,t.jsx)("span",{children:'إزالة شعار "مدعوم من فهيم"'})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(E.Z,{className:"w-5 h-5 text-green-500"}),(0,t.jsx)("span",{children:"تخصيص كامل للألوان والأيقونات"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(E.Z,{className:"w-5 h-5 text-green-500"}),(0,t.jsx)("span",{children:"دعم فني مباشر 24/7"})]}),(0,t.jsx)(i.z,{className:"w-full mt-4",onClick:()=>{w("subscription"),B(!1)},children:"ترقية الباقة الآن"})]})]})})}),(0,t.jsxs)("header",{className:"flex justify-between items-center mb-8 bg-transparent backdrop-blur-md p-2 rounded-md",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"md:hidden",children:(0,t.jsx)(S.Z,{size:"small",showText:!0})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"hidden md:inline",children:"لوحة التحكم"}),(0,t.jsx)("span",{className:"md:hidden",children:"فهملي"})]}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["مرحباً، ",null==v?void 0:v.name,". إليك ملخص نشاط بوتك الذكي."]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>F(!k),"data-tour":"theme-toggle","aria-label":"Toggle theme",className:"h-10 w-10 rounded-full bg-brand-600/10 dark:bg-white/5 flex items-center justify-center hover:bg-brand-600/20 transition-colors",children:k?(0,t.jsx)(x.Z,{className:"w-5 h-5 text-yellow-300"}):(0,t.jsx)(m.Z,{className:"w-5 h-5 text-gray-700"})}),(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-brand-500 flex items-center justify-center text-brand-50 font-bold",children:(null==v?void 0:null===(e=v.name)||void 0===e?void 0:e[0])||"A"})]})]}),(0,t.jsxs)(z.M,{mode:"wait",children:["overview"===N&&(0,t.jsx)(et,{stats:s,subscription:o,kbList:u,chartData:j,user:v,setActiveTab:w},"overview"),"conversations"===N&&(0,t.jsx)(en,{},"conversations"),"live-support"===N&&(0,t.jsx)(ei,{addNotification:W},"live-support"),"channels"===N&&(0,t.jsx)(ec,{addNotification:W},"channels"),"knowledge"===N&&(0,t.jsx)(ef,{addNotification:W},"knowledge"),"tickets"===N&&(0,t.jsx)(eb,{addNotification:W},"tickets"),"widget"===N&&(0,t.jsx)(eN,{user:v,addNotification:W,setShowProAlert:B},"widget"),"team"===N&&(0,t.jsx)(ew,{addNotification:W},"team"),"settings"===N&&(0,t.jsx)(ek,{user:v,addNotification:W},"settings"),"playground"===N&&(0,t.jsx)(eZ,{},"playground"),"analytics"===N&&(0,t.jsx)(ez,{},"analytics"),"subscription"===N&&(0,t.jsx)(A.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-8",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"إدارة الاشتراك"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"قريباً..."})]})},"subscription")]}),(0,t.jsx)("button",{onClick:L,className:"fixed bottom-6 left-6 z-40 p-3 bg-brand-600 hover:bg-brand-700 text-white rounded-full shadow-lg transition-all hover:scale-110",title:"إعادة جولة المساعدة",children:(0,t.jsx)(D.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("footer",{className:"mt-auto pt-8 pb-4 text-center text-sm text-muted-foreground border-t border-border/50 space-y-1",children:[(0,t.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," فهملي - جميع الحقوق محفوظة"]}),(0,t.jsxs)("p",{className:"text-xs flex items-center justify-center gap-2",children:["Development By"," ",(0,t.jsxs)("a",{href:"https://ma-fo.info",target:"_blank",rel:"noopener noreferrer",className:"text-brand-500 hover:text-brand-600 transition-colors flex items-center gap-1",children:[(0,t.jsx)("img",{src:"https://ma-fo.info/logo2.png",alt:"Ma-Fo Logo",className:"w-4 h-4"}),"Ma-Fo"]})]})]})]}),(0,t.jsx)(eF,{run:P,onComplete:_})]})}function eB(){return(0,t.jsx)(F,{children:(0,t.jsx)(eR,{})})}}},function(e){e.O(0,[4736,8592,1744],function(){return e(e.s=7969)}),_N_E=e.O()}]);