(function(){"use strict";var Y,v,he,H,ge,me,ye,ve,ne,oe,re,U={},xe=[],Ge=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,q=Array.isArray;function M(t,e){for(var n in e)t[n]=e[n];return t}function ie(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function be(t,e,n){var r,a,o,s={};for(o in e)o=="key"?r=e[o]:o=="ref"?a=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?Y.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return G(t,s,r,a,null)}function G(t,e,n,r,a){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++he,__i:-1,__u:0};return a==null&&v.vnode!=null&&v.vnode(o),o}function P(t){return t.children}function J(t,e){this.props=t,this.context=e}function D(t,e){if(e==null)return t.__?D(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?D(t):null}function we(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return we(t)}}function ke(t){(!t.__d&&(t.__d=!0)&&H.push(t)&&!K.__r++||ge!=v.debounceRendering)&&((ge=v.debounceRendering)||me)(K)}function K(){for(var t,e,n,r,a,o,s,l=1;H.length;)H.length>l&&H.sort(ye),t=H.shift(),l=H.length,t.__d&&(n=void 0,r=void 0,a=(r=(e=t).__v).__e,o=[],s=[],e.__P&&((n=M({},r)).__v=r.__v+1,v.vnode&&v.vnode(n),ae(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[a]:null,o,a??D(r),!!(32&r.__u),s),n.__v=r.__v,n.__.__k[n.__i]=n,Ie(o,n,s),r.__e=r.__=null,n.__e!=a&&we(n)));K.__r=0}function Se(t,e,n,r,a,o,s,l,f,_,h){var i,c,u,g,S,k,y,m=r&&r.__k||xe,I=e.length;for(f=Je(n,e,m,f,I),i=0;i<I;i++)(u=n.__k[i])!=null&&(c=u.__i==-1?U:m[u.__i]||U,u.__i=i,k=ae(t,u,c,a,o,s,l,f,_,h),g=u.__e,u.ref&&c.ref!=u.ref&&(c.ref&&_e(c.ref,null,u),h.push(u.ref,u.__c||g,u)),S==null&&g!=null&&(S=g),(y=!!(4&u.__u))||c.__k===u.__k?f=Fe(u,f,t,y):typeof u.type=="function"&&k!==void 0?f=k:g&&(f=g.nextSibling),u.__u&=-7);return n.__e=S,f}function Je(t,e,n,r,a){var o,s,l,f,_,h=n.length,i=h,c=0;for(t.__k=new Array(a),o=0;o<a;o++)(s=e[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?s=t.__k[o]=G(null,s,null,null,null):q(s)?s=t.__k[o]=G(P,{children:s},null,null,null):s.constructor==null&&s.__b>0?s=t.__k[o]=G(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):t.__k[o]=s,f=o+c,s.__=t,s.__b=t.__b+1,(_=s.__i=Ke(s,n,f,i))!=-1&&(i--,(l=n[_])&&(l.__u|=2)),l==null||l.__v==null?(_==-1&&(a>h?c--:a<h&&c++),typeof s.type!="function"&&(s.__u|=4)):_!=f&&(_==f-1?c--:_==f+1?c++:(_>f?c--:c++,s.__u|=4))):t.__k[o]=null;if(i)for(o=0;o<h;o++)(l=n[o])!=null&&!(2&l.__u)&&(l.__e==r&&(r=D(l)),Ee(l,l));return r}function Fe(t,e,n,r){var a,o;if(typeof t.type=="function"){for(a=t.__k,o=0;a&&o<a.length;o++)a[o]&&(a[o].__=t,e=Fe(a[o],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=D(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ke(t,e,n,r){var a,o,s,l=t.key,f=t.type,_=e[n],h=_!=null&&(2&_.__u)==0;if(_===null&&l==null||h&&l==_.key&&f==_.type)return n;if(r>(h?1:0)){for(a=n-1,o=n+1;a>=0||o<e.length;)if((_=e[s=a>=0?a--:o++])!=null&&!(2&_.__u)&&l==_.key&&f==_.type)return s}return-1}function Ce(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Ge.test(e)?n:n+"px"}function Q(t,e,n,r,a){var o,s;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Ce(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||Ce(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(ve,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=ne,t.addEventListener(e,o?re:oe,o)):t.removeEventListener(e,o?re:oe,o);else{if(a=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Ae(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ne++;else if(e.t<n.u)return;return n(v.event?v.event(e):e)}}}function ae(t,e,n,r,a,o,s,l,f,_){var h,i,c,u,g,S,k,y,m,I,R,B,E,j,L,N,z,F=e.type;if(e.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),o=[l=e.__e=n.__e]),(h=v.__b)&&h(e);e:if(typeof F=="function")try{if(y=e.props,m="prototype"in F&&F.prototype.render,I=(h=F.contextType)&&r[h.__c],R=h?I?I.props.value:h.__:r,n.__c?k=(i=e.__c=n.__c).__=i.__E:(m?e.__c=i=new F(y,R):(e.__c=i=new J(y,R),i.constructor=F,i.render=Xe),I&&I.sub(i),i.state||(i.state={}),i.__n=r,c=i.__d=!0,i.__h=[],i._sb=[]),m&&i.__s==null&&(i.__s=i.state),m&&F.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=M({},i.__s)),M(i.__s,F.getDerivedStateFromProps(y,i.__s))),u=i.props,g=i.state,i.__v=e,c)m&&F.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),m&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(m&&F.getDerivedStateFromProps==null&&y!==u&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(y,R),e.__v==n.__v||!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(y,i.__s,R)===!1){for(e.__v!=n.__v&&(i.props=y,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function($){$&&($.__=e)}),B=0;B<i._sb.length;B++)i.__h.push(i._sb[B]);i._sb=[],i.__h.length&&s.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(y,i.__s,R),m&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(u,g,S)})}if(i.context=R,i.props=y,i.__P=t,i.__e=!1,E=v.__r,j=0,m){for(i.state=i.__s,i.__d=!1,E&&E(e),h=i.render(i.props,i.state,i.context),L=0;L<i._sb.length;L++)i.__h.push(i._sb[L]);i._sb=[]}else do i.__d=!1,E&&E(e),h=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++j<25);i.state=i.__s,i.getChildContext!=null&&(r=M(M({},r),i.getChildContext())),m&&!c&&i.getSnapshotBeforeUpdate!=null&&(S=i.getSnapshotBeforeUpdate(u,g)),N=h,h!=null&&h.type===P&&h.key==null&&(N=$e(h.props.children)),l=Se(t,q(N)?N:[N],e,n,r,a,o,s,l,f,_),i.base=e.__e,e.__u&=-161,i.__h.length&&s.push(i),k&&(i.__E=i.__=null)}catch($){if(e.__v=null,f||o!=null)if($.then){for(e.__u|=f?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;o[o.indexOf(l)]=null,e.__e=l}else{for(z=o.length;z--;)ie(o[z]);se(e)}else e.__e=n.__e,e.__k=n.__k,$.then||se(e);v.__e($,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=Qe(n.__e,e,n,r,a,o,s,f,_);return(h=v.diffed)&&h(e),128&e.__u?void 0:l}function se(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(se)}function Ie(t,e,n){for(var r=0;r<n.length;r++)_e(n[r],n[++r],n[++r]);v.__c&&v.__c(e,t),t.some(function(a){try{t=a.__h,a.__h=[],t.some(function(o){o.call(a)})}catch(o){v.__e(o,a.__v)}})}function $e(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:q(t)?t.map($e):M({},t)}function Qe(t,e,n,r,a,o,s,l,f){var _,h,i,c,u,g,S,k=n.props||U,y=e.props,m=e.type;if(m=="svg"?a="http://www.w3.org/2000/svg":m=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),o!=null){for(_=0;_<o.length;_++)if((u=o[_])&&"setAttribute"in u==!!m&&(m?u.localName==m:u.nodeType==3)){t=u,o[_]=null;break}}if(t==null){if(m==null)return document.createTextNode(y);t=document.createElementNS(a,m,y.is&&y),l&&(v.__m&&v.__m(e,o),l=!1),o=null}if(m==null)k===y||l&&t.data==y||(t.data=y);else{if(o=o&&Y.call(t.childNodes),!l&&o!=null)for(k={},_=0;_<t.attributes.length;_++)k[(u=t.attributes[_]).name]=u.value;for(_ in k)if(u=k[_],_!="children"){if(_=="dangerouslySetInnerHTML")i=u;else if(!(_ in y)){if(_=="value"&&"defaultValue"in y||_=="checked"&&"defaultChecked"in y)continue;Q(t,_,null,u,a)}}for(_ in y)u=y[_],_=="children"?c=u:_=="dangerouslySetInnerHTML"?h=u:_=="value"?g=u:_=="checked"?S=u:l&&typeof u!="function"||k[_]===u||Q(t,_,u,k[_],a);if(h)l||i&&(h.__html==i.__html||h.__html==t.innerHTML)||(t.innerHTML=h.__html),e.__k=[];else if(i&&(t.innerHTML=""),Se(e.type=="template"?t.content:t,q(c)?c:[c],e,n,r,m=="foreignObject"?"http://www.w3.org/1999/xhtml":a,o,s,o?o[0]:n.__k&&D(n,0),l,f),o!=null)for(_=o.length;_--;)ie(o[_]);l||(_="value",m=="progress"&&g==null?t.removeAttribute("value"):g!=null&&(g!==t[_]||m=="progress"&&!g||m=="option"&&g!=k[_])&&Q(t,_,g,k[_],a),_="checked",S!=null&&S!=t[_]&&Q(t,_,S,k[_],a))}return t}function _e(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(a){v.__e(a,n)}}function Ee(t,e,n){var r,a;if(v.unmount&&v.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||_e(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){v.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(a=0;a<r.length;a++)r[a]&&Ee(r[a],e,n||typeof t.type!="function");n||ie(t.__e),t.__c=t.__=t.__e=void 0}function Xe(t,e,n){return this.constructor(t,n)}function Ze(t,e,n){var r,a,o,s;e==document&&(e=document.documentElement),v.__&&v.__(t,e),a=(r=!1)?null:e.__k,o=[],s=[],ae(e,t=e.__k=be(P,null,[t]),a||U,U,e.namespaceURI,a?null:e.firstChild?Y.call(e.childNodes):null,o,a?a.__e:e.firstChild,r,s),Ie(o,t,s)}Y=xe.slice,v={__e:function(t,e,n,r){for(var a,o,s;e=e.__;)if((a=e.__c)&&!a.__)try{if((o=a.constructor)&&o.getDerivedStateFromError!=null&&(a.setState(o.getDerivedStateFromError(t)),s=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(t,r||{}),s=a.__d),s)return a.__E=a}catch(l){t=l}throw t}},he=0,J.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=M({},this.state),typeof t=="function"&&(t=t(M({},n),this.props)),t&&M(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ke(this))},J.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ke(this))},J.prototype.render=P,H=[],me=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ye=function(t,e){return t.__v.__b-e.__v.__b},K.__r=0,ve=/(PointerCapture)$|Capture$/i,ne=0,oe=Ae(!1),re=Ae(!0);var et=0;function p(t,e,n,r,a,o){e||(e={});var s,l,f=e;if("ref"in f)for(l in f={},e)l=="ref"?s=e[l]:f[l]=e[l];var _={type:t,props:f,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--et,__i:-1,__u:0,__source:a,__self:o};if(typeof t=="function"&&(s=t.defaultProps))for(l in s)f[l]===void 0&&(f[l]=s[l]);return v.vnode&&v.vnode(_),_}var W,x,le,Me,X=0,Re=[],w=v,Te=w.__b,He=w.__r,Be=w.diffed,Ne=w.__c,ze=w.unmount,Oe=w.__;function ce(t,e){w.__h&&w.__h(x,t,X||e),X=0;var n=x.__H||(x.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function A(t){return X=1,tt(Pe,t)}function tt(t,e,n){var r=ce(W++,2);if(r.t=t,!r.__c&&(r.__=[Pe(void 0,e),function(l){var f=r.__N?r.__N[0]:r.__[0],_=r.t(f,l);f!==_&&(r.__N=[_,r.__[1]],r.__c.setState({}))}],r.__c=x,!x.__f)){var a=function(l,f,_){if(!r.__c.__H)return!0;var h=r.__c.__H.__.filter(function(c){return!!c.__c});if(h.every(function(c){return!c.__N}))return!o||o.call(this,l,f,_);var i=r.__c.props!==l;return h.forEach(function(c){if(c.__N){var u=c.__[0];c.__=c.__N,c.__N=void 0,u!==c.__[0]&&(i=!0)}}),o&&o.call(this,l,f,_)||i};x.__f=!0;var o=x.shouldComponentUpdate,s=x.componentWillUpdate;x.componentWillUpdate=function(l,f,_){if(this.__e){var h=o;o=void 0,a(l,f,_),o=h}s&&s.call(this,l,f,_)},x.shouldComponentUpdate=a}return r.__N||r.__}function de(t,e){var n=ce(W++,3);!w.__s&&Ue(n.__H,e)&&(n.__=t,n.u=e,x.__H.__h.push(n))}function De(t){return X=5,nt(function(){return{current:t}},[])}function nt(t,e){var n=ce(W++,7);return Ue(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function ot(){for(var t;t=Re.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Z),t.__H.__h.forEach(ue),t.__H.__h=[]}catch(e){t.__H.__h=[],w.__e(e,t.__v)}}w.__b=function(t){x=null,Te&&Te(t)},w.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Oe&&Oe(t,e)},w.__r=function(t){He&&He(t),W=0;var e=(x=t.__c).__H;e&&(le===x?(e.__h=[],x.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(Z),e.__h.forEach(ue),e.__h=[],W=0)),le=x},w.diffed=function(t){Be&&Be(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Re.push(e)!==1&&Me===w.requestAnimationFrame||((Me=w.requestAnimationFrame)||rt)(ot)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),le=x=null},w.__c=function(t,e){e.some(function(n){try{n.__h.forEach(Z),n.__h=n.__h.filter(function(r){return!r.__||ue(r)})}catch(r){e.some(function(a){a.__h&&(a.__h=[])}),e=[],w.__e(r,n.__v)}}),Ne&&Ne(t,e)},w.unmount=function(t){ze&&ze(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Z(r)}catch(a){e=a}}),n.__H=void 0,e&&w.__e(e,n.__v))};var Le=typeof requestAnimationFrame=="function";function rt(t){var e,n=function(){clearTimeout(r),Le&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);Le&&(e=requestAnimationFrame(n))}function Z(t){var e=x,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),x=e}function ue(t){var e=x;t.__c=t.__(),x=e}function Ue(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function Pe(t,e){return typeof e=="function"?e(t):e}const We=(t,e)=>"#"+t.replace(/^#/,"").replace(/../g,n=>("0"+Math.min(255,Math.max(0,parseInt(n,16)+e)).toString(16)).substr(-2)),ee=()=>Math.random().toString(36).substring(2,15);function it({config:t,variant:e,businessId:n,assetBaseUrl:r}){var Ye,qe;const[a,o]=A(!1),[s,l]=A([]),[f,_]=A(""),[h,i]=A(!1),[c,u]=A(!1),[g,S]=A(null),[k,y]=A(!1),[m,I]=A(0),[R,B]=A(0),[E,j]=A(!1),[L,N]=A(""),z=De(null),F=De(null),$=`fahimo-chat-${n}`;de(()=>{let d=localStorage.getItem(`fahimo-visitor-${n}`);d||(d=`v_${ee()}`,localStorage.setItem(`fahimo-visitor-${n}`,d)),N(d);const b=localStorage.getItem($);if(b)try{const C=JSON.parse(b);l(C.messages||[]),S(C.conversationId),I(C.rating||0),j(C.ratingSubmitted||!1)}catch(C){console.error("Failed to load chat session:",C)}const O=localStorage.getItem(`fahimo-mute-${n}`);O&&i(O==="true")},[n,$]),de(()=>{if(s.length>0||g){const d={conversationId:g,messages:s,rating:m,ratingSubmitted:E};localStorage.setItem($,JSON.stringify(d))}},[s,g,m,E,$]),de(()=>{var d;(d=F.current)==null||d.scrollIntoView({behavior:"smooth"})},[s]);const at=()=>{const d=!h;i(d),localStorage.setItem(`fahimo-mute-${n}`,String(d))},pe=()=>{!h&&z.current&&z.current.play().catch(()=>{})},je=()=>{const d=!a;o(d),d&&pe()},Ve=async()=>{var O;if(!f.trim()||c)return;const d=f.trim(),b={id:ee(),text:d,sender:"user",timestamp:Date.now()};l(C=>[...C,b]),_(""),u(!0),pe();try{const C=window.__FAHIMO_API_URL||"https://fahimo-api.onrender.com",fe=String(C).trim().replace(/\/+$/,"").replace(/\/api$/i,""),V=await fetch(`${fe}/api/chat/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({businessId:n,conversationId:g,visitorId:L,content:d,senderType:"USER"})});if(!V.ok)throw new Error(`HTTP ${V.status}`);const te=await V.json();te.conversationId&&!g&&S(te.conversationId);const ct={id:ee(),text:te.content||((O=te.botMessage)==null?void 0:O.content)||"Sorry, I could not process your message.",sender:"bot",timestamp:Date.now()};l(dt=>[...dt,ct]),pe()}catch(C){console.error("Chat error:",C);const fe={id:ee(),text:"Sorry, there was an error. Please try again.",sender:"bot",timestamp:Date.now()};l(V=>[...V,fe])}finally{u(!1)}},st=async d=>{I(d),j(!0);try{const b=window.__FAHIMO_API_URL||"https://fahimo-api.onrender.com",O=String(b).trim().replace(/\/+$/,"").replace(/\/api$/i,"");await fetch(`${O}/api/chat/rate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({businessId:n,conversationId:g,rating:d})})}catch(b){console.error("Rating submission error:",b)}setTimeout(()=>y(!1),2e3)},_t=()=>{!E&&s.length>0&&y(!0)},T=t.primaryColor||"#6366F1",lt=typeof window<"u"&&((Ye=window.location)!=null&&Ye.origin)?`${window.location.origin}/sounds/notification.mp3`:"/sounds/notification.mp3";return p("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:2147483647,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:[p("audio",{ref:z,src:lt,preload:"auto"}),a&&p("div",{style:{width:e==="enhanced"?"380px":"360px",height:e==="enhanced"?"580px":"520px",backgroundColor:"#ffffff",borderRadius:"20px",boxShadow:"0 20px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",marginBottom:"16px",overflow:"hidden",animation:"fahimo-balloon-in 0.45s cubic-bezier(0.34, 1.56, 0.64, 1)",transformOrigin:"bottom right"},children:[p("style",{children:`
            @keyframes fahimo-balloon-in {
              0% { 
                opacity: 0; 
                transform: scale(0.3) translateY(30px); 
              }
              60% { 
                boxShadow: '0 24px 80px rgba(0,0,0,0.18), 0 0 0 1px rgba(15,23,42,0.06)',
                transform: scale(1.08) translateY(0); 
              }
              100% { 
                transform: scale(1) translateY(0); 
                animation: 'fahimo-open 360ms cubic-bezier(0.22, 1, 0.36, 1)',
            }
            @keyframes fahimo-fade-in {
              from { opacity: 0; transform: translateY(8px); }
                  @keyframes fahimo-open {
                    0% {
                      opacity: 0;
                      transform: translate3d(0, 16px, 0) scale(0.92);
                      filter: blur(2px);
                    }
                    60% {
                      opacity: 1;
                      transform: translate3d(0, 0, 0) scale(1.01);
                      filter: blur(0);
                    }
                    100% {
                      opacity: 1;
                      transform: translate3d(0, 0, 0) scale(1);
                      filter: blur(0);
                    }
                  }
            .fahimo-msg { animation: fahimo-fade-in 0.3s ease-out forwards; }
            .fahimo-typing span { animation: fahimo-pulse 1.4s infinite; }
            .fahimo-typing span:nth-child(2) { animation-delay: 0.2s; }
            .fahimo-typing span:nth-child(3) { animation-delay: 0.4s; }
            .fahimo-star { cursor: pointer; transition: transform 0.2s, color 0.2s; }
            .fahimo-star:hover { transform: scale(1.2); }
            .fahimo-star.selected { animation: fahimo-star-pop 0.3s ease-out; }
          `}),p("div",{style:{background:`linear-gradient(145deg, ${T}, ${We(T,-25)})`,color:"white",padding:"18px 20px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[p("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[p("div",{style:{position:"relative"},children:[p("div",{style:{width:44,height:44,borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px"},children:"ðŸ¤–"}),p("div",{style:{position:"absolute",bottom:0,right:0,width:12,height:12,backgroundColor:"#22C55E",borderRadius:"50%",border:"2px solid white"}})]}),p("div",{children:[p("div",{style:{fontWeight:"600",fontSize:"15px"},children:((qe=t.welcomeMessage)==null?void 0:qe.split("!")[0])||"AI Assistant"}),p("div",{style:{fontSize:"12px",opacity:.85,display:"flex",alignItems:"center",gap:"5px"},children:[p("span",{style:{width:6,height:6,backgroundColor:"#22C55E",borderRadius:"50%"}}),"Always online"]})]})]}),p("div",{style:{display:"flex",gap:"8px"},children:[p("button",{onClick:at,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"white",cursor:"pointer",width:34,height:34,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",transition:"background 0.2s"},onMouseOver:d=>d.currentTarget.style.background="rgba(255,255,255,0.25)",onMouseOut:d=>d.currentTarget.style.background="rgba(255,255,255,0.15)",children:h?"ðŸ”‡":"ðŸ”Š"}),s.length>0&&p("button",{onClick:_t,title:"End & Rate",style:{background:"rgba(255,255,255,0.15)",border:"none",color:"white",cursor:"pointer",width:34,height:34,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",transition:"background 0.2s"},onMouseOver:d=>d.currentTarget.style.background="rgba(255,255,255,0.25)",onMouseOut:d=>d.currentTarget.style.background="rgba(255,255,255,0.15)",children:"â­"}),p("button",{onClick:je,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"white",cursor:"pointer",width:34,height:34,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",transition:"background 0.2s"},onMouseOver:d=>d.currentTarget.style.background="rgba(255,255,255,0.25)",onMouseOut:d=>d.currentTarget.style.background="rgba(255,255,255,0.15)",children:"âœ•"})]})]}),k&&p("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.97)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:10,animation:"fahimo-fade-in 0.3s ease-out"},children:E?p("div",{style:{textAlign:"center"},children:[p("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ðŸŽ‰"}),p("div",{style:{fontSize:"18px",fontWeight:"600",color:"#1F2937"},children:"Thank you!"}),p("div",{style:{fontSize:"14px",color:"#6B7280",marginTop:"8px"},children:"Your feedback helps us improve"})]}):p(P,{children:[p("div",{style:{fontSize:"16px",fontWeight:"600",color:"#1F2937",marginBottom:"8px"},children:"How was your experience?"}),p("div",{style:{fontSize:"13px",color:"#6B7280",marginBottom:"20px"},children:"Rate your conversation"}),p("div",{style:{display:"flex",gap:"8px"},children:[1,2,3,4,5].map(d=>p("span",{className:`fahimo-star ${m>=d?"selected":""}`,onClick:()=>st(d),onMouseEnter:()=>B(d),onMouseLeave:()=>B(0),style:{fontSize:"36px",color:(R||m)>=d?"#FBBF24":"#E5E7EB",transition:"color 0.2s"},children:"â˜…"},d))}),p("button",{onClick:()=>y(!1),style:{marginTop:"24px",padding:"8px 20px",background:"transparent",border:"1px solid #E5E7EB",borderRadius:"20px",color:"#6B7280",cursor:"pointer",fontSize:"13px"},children:"Skip"})]})}),p("div",{className:"fahimo-scroll",style:{flex:1,padding:"20px",overflowY:"auto",backgroundColor:"#F9FAFB",display:"flex",flexDirection:"column",gap:"14px"},children:[s.length===0&&p("div",{style:{textAlign:"center",marginTop:"60px",animation:"fahimo-fade-in 0.5s ease-out"},children:[p("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ðŸ‘‹"}),p("div",{style:{fontSize:"16px",fontWeight:"600",color:"#1F2937",marginBottom:"8px"},children:t.welcomeMessage||"Hello! How can I help you today?"}),p("div",{style:{fontSize:"13px",color:"#9CA3AF"},children:"Ask me anything, I'm here to help!"})]}),s.map(d=>p("div",{className:"fahimo-msg",style:{alignSelf:d.sender==="user"?"flex-end":"flex-start",maxWidth:"80%"},children:[p("div",{style:{padding:"12px 16px",borderRadius:d.sender==="user"?"18px 18px 4px 18px":"18px 18px 18px 4px",backgroundColor:d.sender==="user"?T:"white",color:d.sender==="user"?"white":"#1F2937",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",fontSize:"14px",lineHeight:"1.5",wordBreak:"break-word"},children:d.text}),p("div",{style:{fontSize:"11px",color:"#9CA3AF",marginTop:"4px",textAlign:d.sender==="user"?"right":"left",paddingLeft:"4px",paddingRight:"4px"},children:new Date(d.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},d.id)),c&&p("div",{className:"fahimo-msg",style:{alignSelf:"flex-start"},children:p("div",{className:"fahimo-typing",style:{padding:"14px 20px",borderRadius:"18px 18px 18px 4px",backgroundColor:"white",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",display:"flex",gap:"4px"},children:[p("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"#9CA3AF"}}),p("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"#9CA3AF"}}),p("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"#9CA3AF"}})]})}),p("div",{ref:F})]}),p("div",{style:{padding:"12px",borderTop:"1px solid #F3F4F6",backgroundColor:"white"},children:p("div",{style:{display:"flex",gap:"8px",alignItems:"flex-end"},children:[p("textarea",{value:f,onInput:d=>{const b=d.target;_(b.value),b.style.height="auto",b.style.height=Math.min(b.scrollHeight,88)+"px"},onKeyDown:d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),Ve())},placeholder:"Type your message...",disabled:c,style:{flex:1,padding:"10px 14px",borderRadius:"20px",border:"1px solid #E5E7EB",outline:"none",fontSize:"14px",resize:"none",height:"40px",maxHeight:"88px",fontFamily:"inherit",backgroundColor:"#F9FAFB",boxSizing:"border-box",transition:"border-color 0.2s, box-shadow 0.2s, background-color 0.2s"},onFocus:d=>{const b=d.target;b.style.borderColor=T,b.style.boxShadow=`0 0 0 3px ${T}20`,b.style.backgroundColor="white"},onBlur:d=>{const b=d.target;b.style.borderColor="#E5E7EB",b.style.boxShadow="none",b.style.backgroundColor="#F9FAFB"}}),p("button",{onClick:Ve,disabled:!f.trim()||c,style:{padding:"0",borderRadius:"50%",backgroundColor:f.trim()&&!c?T:"#E5E7EB",color:"white",border:"none",cursor:f.trim()&&!c?"pointer":"not-allowed",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",flexShrink:0},children:p("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[p("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),p("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})}),p("div",{style:{textAlign:"center",padding:"10px",fontSize:"11px",color:"#9CA3AF",backgroundColor:"#F9FAFB",borderTop:"1px solid #F3F4F6"},children:["Powered by ",p("a",{href:"https://faheemly.com",target:"_blank",rel:"noopener",style:{color:T,textDecoration:"none",fontWeight:"600"},children:"Faheemly AI"})]})]}),!a&&p("button",{onClick:je,style:{width:"64px",height:"64px",borderRadius:"32px",background:`linear-gradient(145deg, ${T}, ${We(T,-20)})`,color:"white",border:"none",boxShadow:"0 6px 24px rgba(0,0,0,0.18)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s",animation:"fahimo-pop-in 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)"},onMouseOver:d=>{d.currentTarget.style.transform="scale(1.1)",d.currentTarget.style.boxShadow="0 8px 32px rgba(0,0,0,0.22)"},onMouseOut:d=>{d.currentTarget.style.transform="scale(1)",d.currentTarget.style.boxShadow="0 6px 24px rgba(0,0,0,0.18)"},children:[p("style",{children:`
            @keyframes fahimo-pop-in {
              from { transform: scale(0) rotate(-180deg); opacity: 0; }
              to { transform: scale(1) rotate(0); opacity: 1; }
            }
          `}),p("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:p("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),s.length>0&&p("div",{style:{position:"absolute",top:"-2px",right:"-2px",width:"18px",height:"18px",backgroundColor:"#EF4444",borderRadius:"50%",border:"2px solid white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:s.length>9?"9+":s.length})]})]})}(function(){if(window.__FAHIMO_WIDGET_LOADER)return;window.__FAHIMO_WIDGET_LOADER={initialized:!0};const t=document.currentScript,e=t==null?void 0:t.getAttribute("data-business-id");if(!e){console.error("[Fahimo] Business ID is missing.");return}let n="https://fahimo-api.onrender.com";const r=t.getAttribute("data-api-url");r&&(n=r);let a="https://fahimo.com";if(t.src)try{a=new URL(t.src).origin}catch{console.warn("[Fahimo] Could not determine asset base URL from script src")}let o=null;function s(){return`${n.replace(/\/+$/,"").replace(/\/api$/i,"")}/api/widget/config/${e}`}function l(){if(o&&document.body.contains(o))return o;const c=document.getElementById("fahimo-widget-root");if(c)return o=c,c;const u=document.createElement("div");return u.id="fahimo-widget-root",document.body.appendChild(u),o=u,u}function f(c){const u=l();window.__FAHIMO_CONFIG=c,window.__FAHIMO_API_URL=n,window.__FAHIMO_BUSINESS_ID=e;const g=String((c==null?void 0:c.widgetVariant)||"STANDARD").toLowerCase()==="enhanced"?"enhanced":"standard";Ze(be(it,{config:(c==null?void 0:c.widgetConfig)||{},variant:g,businessId:e,assetBaseUrl:a,businessName:c==null?void 0:c.name,preChatFormEnabled:c==null?void 0:c.preChatFormEnabled}),u)}async function _(){const u=await(await fetch(s(),{cache:"no-store"})).json();if(!u||!u.widgetConfig)throw new Error("Invalid config");f(u)}function h(){_().catch(c=>{console.error("[Fahimo] Failed to load widget config:",c)})}document.readyState==="complete"||document.readyState==="interactive"?h():window.addEventListener("DOMContentLoaded",h),new MutationObserver(c=>{document.body.contains(o)||h()}).observe(document.body,{childList:!0,subtree:!1});try{const c=`fahimo-config-update-${e}`;if(typeof BroadcastChannel<"u"){const g=new BroadcastChannel(c);g.onmessage=()=>{_().catch(()=>{})}}const u=`fahimo-config-update-${e}-notify`;window.addEventListener("storage",g=>{g&&g.key===u&&_().catch(()=>{})})}catch{}})()})();
